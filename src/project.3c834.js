window.__require=function t(e,n,i){function o(a,s){if(!n[a]){if(!e[a]){var c=a.split("/");if(c=c[c.length-1],!e[c]){var l="function"==typeof __require&&__require;if(!s&&l)return l(c,!0);if(r)return r(c,!0);throw new Error("Cannot find module '"+a+"'")}}var u=n[a]={exports:{}};e[a][0].call(u.exports,function(t){return o(e[a][1][t]||t)},u,u.exports,t,e,n,i)}return n[a].exports}for(var r="function"==typeof __require&&__require,a=0;a<i.length;a++)o(i[a]);return o}({Astar:[function(t,e,n){"use strict";cc._RF.push(e,"7b5d59O2xRJPLvP32T7QogL","Astar");var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(e,n,i){o(this,t),this.parentNode=i,this.position=e,this.gValue=i?i.getGValue()+1:0,this.fValue=this.gValue+n}return i(t,[{key:"getParentNode",value:function(){return this.parentNode}},{key:"getPosition",value:function(){return this.position}},{key:"getGValue",value:function(){return this.gValue}},{key:"getFValue",value:function(){return this.fValue}},{key:"equal",value:function(t){return this.position.x==t.x&&this.position.y==t.y}},{key:"add",value:function(t){return{x:this.position.x+t.x,y:this.position.y+t.y}}}]),t}(),a=[{x:0,y:1},{x:0,y:-1},{x:-1,y:0},{x:1,y:0}],s=function(){function t(){o(this,t)}return i(t,[{key:"estimateHValue",value:function(t,e){return Math.abs(t.x-e.x)+Math.abs(t.y-e.y)}},{key:"contain",value:function(t){return this.activeNodes[t.y*this.map[0].length+t.x]}},{key:"isEmptyPlace",value:function(t){if(this.map[t.y]){var e=this.map[t.y][t.x];return!!e&&0!==e}return!1}},{key:"activedNode",value:function(t){this.activeNodes[t.y*this.map[0].length+t.x]=!0}},{key:"addSquareNode",value:function(t,e){var n=this;if(t){this.activedNode(t.getPosition());var i=null;a.forEach(function(o){i=t.add(o),!n.contain(i)&&n.isEmptyPlace(i)&&(n.activedNode(i),n.openList.push(new r(i,n.estimateHValue(i,e),t)))}),this.openList.sort(function(t,e){return t.getFValue()==e.getFValue()?e.getGValue()-t.getGValue():t.getFValue()-e.getFValue()})}}},{key:"makePath",value:function(t,e){var n=this.estimateHValue(t,e);if(0!=n){this.openList=[],this.activeNodes={};var i=[],o=new r(t,n,null);this.openList.push(o);for(var a=null;this.openList.length>0;){if((o=this.openList.shift()).equal(e)){a=o;break}this.addSquareNode(o,e)}for(;a;)i.push(a),a=a.getParentNode();return i.reverse(),i}}},{key:"getPath",value:function(t,e,n){return this.map=t,this.makePath(e,n)}}]),t}();e.exports=s,cc._RF.pop()},{}],GodGuide:[function(t,e,n){"use strict";cc._RF.push(e,"64b06+rReZCwp763r4qkMJ4","GodGuide");var i=t("async"),o=t("locator"),r=t("guideCommand"),a=2*Math.PI/360;function s(t,e,n){var i=cc.v2(),o=-e*a;return i.x=(t.x-n.x)*Math.cos(o)-(t.y-n.y)*Math.sin(o)+n.x,i.y=(t.x-n.x)*Math.sin(o)+(t.y-n.y)*Math.cos(o)+n.y,i}function c(t,e,n){return[cc.v2(t.x,t.y),cc.v2(t.x+t.width,t.y),cc.v2(t.x+t.width,t.y+t.height),cc.v2(t.x,t.y+t.height)].map(function(t){return s(t,e,n)})}var l=cc.Class({extends:cc.Component,properties:{type:{default:cc.Mask.Type.RECT,type:cc.Mask.Type},FINGER_PREFAB:cc.Prefab,TEXT_PREFAB:cc.Prefab},statics:{find:function(t,e){var n=cc.find("Canvas");o.locateNode(n,t,e)}},onLoad:function(){this.init(),window.GodGuide=this},init:function(){var t=this;this.node.setContentSize(cc.winSize),this._fromNode=null,this._targetNode=null,this.FINGER_PREFAB&&(this._finger=cc.instantiate(this.FINGER_PREFAB),this._finger.parent=this.node,this._finger.active=!1),this.TEXT_PREFAB&&(this._text=cc.instantiate(this.TEXT_PREFAB),this._text.parent=this.node,this._text.active=!1),this._mask=this.node.getComponentInChildren(cc.Mask),this._mask.inverted=!0,this._mask.node.active=!1,this.node.on(cc.Node.EventType.TOUCH_START,function(e){if(t._mask.node.active)if(t._targetNode){cc.log("\u81ea\u52a8\u8282\u70b9 :",JSON.stringify(t._targetNode.position));var n=t._targetNode.convertToWorldSpaceAR(t._targetNode.position);if(cc.log("\u4e16\u754c\u8282\u70b9 :",JSON.stringify(n)),t._fromNode)if(t._fromNode.getBoundingBoxToWorld().contains(e.getLocation()))return void t.node._touchListener.setSwallowTouches(!1);t._targetNode.getBoundingBoxToWorld().contains(e.getLocation())?(t.node._touchListener.setSwallowTouches(!1),cc.log("targetNode\u547d\u4e2d\u76ee\u6807\u8282\u70b9\uff0c\u653e\u884c")):(t.node._touchListener.setSwallowTouches(!0),cc.log("\u672a\u547d\u4e2d\u76ee\u6807\u8282\u70b9\uff0c\u62e6\u622a"))}else t.node._touchListener.setSwallowTouches(!0);else t.node._touchListener.setSwallowTouches(!1)},this)},start:function(){},setTask:function(t){this._task?cc.warn("\u5f53\u524d\u4efb\u52a1\u8fd8\u672a\u5904\u7406\u5b8c\u6bd5\uff01"):this._task=t},getTask:function(){return this._task},run:function(t){var e=this;this._task&&i.eachSeries(this._task.steps,function(t,n){e._processStep(t,n)},function(){e._task=null,cc.log("\u4efb\u52a1\u7ed3\u675f"),e._mask.node.active=!1,e._finger&&(e._finger.active=!1),t&&t()})},_processStep:function(t,e){var n=this;i.series({stepStart:function(e){t.onStart?t.onStart(function(){e()}):e()},stepCommand:function(e){n._mask.node.active=n._task.mask||!0,n.scheduleOnce(function(){n._processStepCommand(t,function(){e()})},t.delayTime||0)},taskEnd:function(e){n._mask._graphics.clear(),n._finger.active=!1,t.onEnd?t.onEnd(function(){e()}):e()}},function(n){cc.log("\u6b65\u9aa4\u3010"+t.desc+"\u3011\u7ed3\u675f\uff01"),e()})},fingerToNode:function(t,e){this._finger||e(),this._finger.active=!0;var n=this.node.convertToNodeSpaceAR(t.parent.convertToWorldSpaceAR(t.position)),i=n.sub(this._finger.position).mag()/cc.winSize.height,o=cc.moveTo(i,n),r=cc.callFunc(function(){e()}),a=cc.sequence(o,r);this._finger.runAction(a)},moveToNode:function(t,e,n){this._finger||n(),this._finger.active=!0;var i=null;this._fromNode?(i=this.node.convertToNodeSpaceAR(t.parent.convertToWorldSpaceAR(t.position)),cc.log(i)):i=this.node.convertToNodeSpaceAR(e.parent.convertToWorldSpaceAR(e.position));var o=this.node.convertToNodeSpaceAR(e.parent.convertToWorldSpaceAR(e.position));cc.log(i+"||"+o),this._finger.setPosition(i);var r=o.sub(this._finger.position).mag()/cc.winSize.height,a=cc.moveTo(r,o),s=cc.callFunc(function(){n()}),c=cc.sequence(a,s);this._finger.runAction(c)},moveToTower:function(t,e,n){cc.log("fromNode.position"+t.position),cc.log("targetNode.position"+e.position),this._finger||n(),this._finger.active=!0;var i=null;this._fromNode?(i=this.node.convertToNodeSpaceAR(t.parent.convertToWorldSpaceAR(t.position)),cc.log(i)):i=this.node.convertToNodeSpaceAR(e.parent.convertToWorldSpaceAR(e.position));var o=this.node.convertToNodeSpaceAR(e.parent.convertToWorldSpaceAR(e.position));this._finger.setPosition(i);var r=o.sub(this._finger.position).mag()/cc.winSize.height,a=cc.moveTo(r,o),s=cc.callFunc(function(){n()}),c=cc.sequence(a,s);this._finger.runAction(c)},_processStepCommand:function(t,e){var n=r[t.command.cmd];n?(cc.log("\u6267\u884c\u6b65\u9aa4\u3010"+t.desc+"\u3011\u6307\u4ee4: "+t.command.cmd),n(this,t,function(){cc.log("\u6b65\u9aa4\u3010"+t.desc+"\u3011\u6307\u4ee4: "+t.command.cmd+" \u6267\u884c\u5b8c\u6bd5"),e()})):(cc.log("\u6267\u884c\u6b65\u9aa4\u3010"+t.desc+"\u3011\u6307\u4ee4: "+t.command.cmd+" \u4e0d\u5b58\u5728\uff01"),e())},find:function(t,e){var n=this,i=cc.find("Canvas");o.locateNode(i,t,function(t,i){if(t)cc.log(t);else{cc.log("\u5b9a\u4f4d\u8282\u70b9\u6210\u529f");var o=n._focusToNode(i);e&&e(i,o)}})},findNode:function(t,e){var n=cc.find("Canvas");return cc.log("findNode \u5b9a\u4f4d\u8282\u70b9\u6210\u529f"),o.locateNode(n,t,e)},locateNodeByEvent:function(t){this.selector=t.string},getNodePoints:function(t,e,n){return c(t,e,n).map(function(t){return t})},fillPolygon:function(t){var e=this,n=t[0];this._mask._graphics.moveTo(n.x,n.y),t.slice(1).forEach(function(t){e._mask._graphics.lineTo(t.x,t.y)}),this._mask._graphics.lineTo(n.x,n.y),this._mask._graphics.stroke(),this._mask._graphics.fill()},_focusToNode:function(t){this._mask._graphics.clear();var e=t.getBoundingBoxToWorld(),n=this.node.convertToNodeSpaceAR(e.origin);return e.x=n.x,e.y=n.y,this._mask._graphics.fillRect(e.x,e.y,e.width,e.height),e},focusFromNodeToTargetNode:function(t,e){this._mask._graphics.clear();var n=t.getBoundingBoxToWorld(),i=e.getBoundingBoxToWorld(),o=this.node.convertToNodeSpaceAR(n.origin);this.node.convertToNodeSpaceAR(i.origin);return this._mask._graphics.fillRect(o.x,o.y,n.width+i.width,n.height),n},focusFormNodeToTowerNode:function(t,e){this._mask._graphics.clear();var n=t.getBoundingBoxToWorld(),i=e.getBoundingBoxToWorld(),o=this.node.convertToNodeSpaceAR(n.origin),r=this.node.convertToNodeSpaceAR(i.origin).y-o.y;this._mask._graphics.fillRect(o.x,o.y,n.width,r+i.height/2)},getNodeFullPath:function(t){var e=[],n=t;do{e.unshift(n.name),n=n.parent}while(n&&"Canvas"!==n.name);return cc.log(e.join("/")),e.join("/")},isGuideNode:function(t){var e=!1,n=t;do{if(n===this.node){e=!0;break}}while(n=n.parent);return e},showText:function(t,e){cc.log(this.TEXT_PREFAB.name),this._text.once("click",e),this._text.getComponent(this.TEXT_PREFAB.name).text=t},showTextNoCallBack:function(t,e){this._text.getComponent(this.TEXT_PREFAB.name).text=t,e()}});e.exports=l,cc._RF.pop()},{async:"async",guideCommand:"guideCommand",locator:"locator"}],GodText:[function(t,e,n){"use strict";cc._RF.push(e,"32239EgpdZA+YDdGlOgAM4g","GodText"),cc.Class({extends:cc.Component,properties:{text:{default:"",notify:function(){this._updateContent()}}},start:function(){var t=this;this.node.on(cc.Node.EventType.TOUCH_START,function(){if(t.node._touchListener.setSwallowTouches(!1),t.node.active)return t.node.active=!1,void t.node.emit("click")})},_updateContent:function(){this.node.active=!0,this.label||(this.label=this.node.getComponentInChildren(cc.Label)),this.label.string=this.text}}),cc._RF.pop()},{}],1:[function(t,e,n){var i,o,r=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function c(t){if(i===setTimeout)return setTimeout(t,0);if((i===a||!i)&&setTimeout)return i=setTimeout,setTimeout(t,0);try{return i(t,0)}catch(e){try{return i.call(null,t,0)}catch(e){return i.call(this,t,0)}}}function l(t){if(o===clearTimeout)return clearTimeout(t);if((o===s||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(t);try{return o(t)}catch(e){try{return o.call(null,t)}catch(e){return o.call(this,t)}}}(function(){try{i="function"==typeof setTimeout?setTimeout:a}catch(t){i=a}try{o="function"==typeof clearTimeout?clearTimeout:s}catch(t){o=s}})();var u,h=[],f=!1,d=-1;function g(){f&&u&&(f=!1,u.length?h=u.concat(h):d=-1,h.length&&p())}function p(){if(!f){var t=c(g);f=!0;for(var e=h.length;e;){for(u=h,h=[];++d<e;)u&&u[d].run();d=-1,e=h.length}u=null,f=!1,l(t)}}function v(t,e){this.fun=t,this.array=e}function m(){}r.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];h.push(new v(t,e)),1!==h.length||f||c(p)},v.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=m,r.addListener=m,r.once=m,r.off=m,r.removeListener=m,r.removeAllListeners=m,r.emit=m,r.prependListener=m,r.prependOnceListener=m,r.listeners=function(t){return[]},r.binding=function(t){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(t){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},{}],async:[function(t,e,n){(function(t,i){"use strict";cc._RF.push(e,"ee6d80p2GFGVpRr0GCveod+","async");var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t,i){"object"==(void 0===n?"undefined":o(n))&&void 0!==e?i(n):"function"==typeof define&&define.amd?define(["exports"],i):i(t.async=t.async||{})}(void 0,function(n){function r(t,e){e|=0;for(var n=Math.max(t.length-e,0),i=Array(n),o=0;o<n;o++)i[o]=t[e+o];return i}function a(t){var e=void 0===t?"undefined":o(t);return null!=t&&("object"==e||"function"==e)}function s(t){setTimeout(t,0)}function c(t){return function(e){var n=r(arguments,1);t(function(){e.apply(null,n)})}}function l(t){return oe(function(e,n){var i;try{i=t.apply(this,e)}catch(t){return n(t)}a(i)&&"function"==typeof i.then?i.then(function(t){u(n,null,t)},function(t){u(n,t.message?t:new Error(t))}):n(null,i)})}function u(t,e,n){try{t(e,n)}catch(t){se(h,t)}}function h(t){throw t}function f(t){return ce&&"AsyncFunction"===t[Symbol.toStringTag]}function d(t){return f(t)?l(t):t}function g(t){return function(e){var n=r(arguments,1),i=oe(function(n,i){var o=this;return t(e,function(t,e){d(t).apply(o,n.concat(e))},i)});return n.length?i.apply(this,n):i}}function p(t){var e=ge.call(t,ve),n=t[ve];try{t[ve]=void 0;var i=!0}catch(t){}var o=pe.call(t);return i&&(e?t[ve]=n:delete t[ve]),o}function v(t){return me.call(t)}function m(t){return null==t?void 0===t?ye:be:Ce&&Ce in Object(t)?p(t):v(t)}function b(t){if(!a(t))return!1;var e=m(t);return e==Te||e==Ie||e==Se||e==Be}function y(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=_e}function C(t){return null!=t&&y(t.length)&&!b(t)}function S(){}function T(t){return function(){if(null!==t){var e=t;t=null,e.apply(this,arguments)}}}function I(t,e){for(var n=-1,i=Array(t);++n<t;)i[n]=e(n);return i}function B(t){return null!=t&&"object"==(void 0===t?"undefined":o(t))}function _(t){return B(t)&&m(t)==Ne}function x(t,e){return!!(e=null==e?je:e)&&("number"==typeof t||Ge.test(t))&&t>-1&&t%1==0&&t<e}function w(t,e){var n=ke(t),i=!n&&Ee(t),o=!n&&!i&&De(t),r=!n&&!i&&!o&&qe(t),a=n||i||o||r,s=a?I(t.length,String):[],c=s.length;for(var l in t)!e&&!Je.call(t,l)||a&&("length"==l||o&&("offset"==l||"parent"==l)||r&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||x(l,c))||s.push(l);return s}function R(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||Ke)}function N(t){if(!R(t))return Ze(t);var e=[];for(var n in Object(t))Ye.call(t,n)&&"constructor"!=n&&e.push(n);return e}function M(t){return C(t)?w(t):N(t)}function F(t){var e=-1,n=t.length;return function(){return++e<n?{value:t[e],key:e}:null}}function P(t){var e=-1;return function(){var n=t.next();return n.done?null:(e++,{value:n.value,key:e})}}function E(t){var e=M(t),n=-1,i=e.length;return function(){var o=e[++n];return n<i?{value:t[o],key:o}:null}}function k(t){if(C(t))return F(t);var e=Re(t);return e?P(e):E(t)}function A(t){return function(){if(null===t)throw new Error("Callback was already called.");var e=t;t=null,e.apply(this,arguments)}}function L(t){return function(e,n,i){function o(t,e){if(c-=1,t)s=!0,i(t);else{if(e===xe||s&&c<=0)return s=!0,i(null);r()}}function r(){for(;c<t&&!s;){var e=a();if(null===e)return s=!0,void(c<=0&&i(null));c+=1,n(e.value,e.key,A(o))}}if(i=T(i||S),t<=0||!e)return i(null);var a=k(e),s=!1,c=0;r()}}function O(t,e,n,i){L(e)(t,d(n),i)}function D(t,e){return function(n,i,o){return t(n,e,i,o)}}function j(t,e,n){function i(t,e){t?n(t):++r!==a&&e!==xe||n(null)}n=T(n||S);var o=0,r=0,a=t.length;for(0===a&&n(null);o<a;o++)e(t[o],o,A(i))}function G(t){return function(e,n,i){return t($e,e,d(n),i)}}function V(t,e,n,i){i=i||S,e=e||[];var o=[],r=0,a=d(n);t(e,function(t,e,n){var i=r++;a(t,function(t,e){o[i]=e,n(t)})},function(t){i(t,o)})}function U(t){return function(e,n,i,o){return t(L(n),e,d(i),o)}}function H(t,e){for(var n=-1,i=null==t?0:t.length;++n<i&&!1!==e(t[n],n,t););return t}function z(t,e){return t&&an(t,e,M)}function W(t,e,n,i){for(var o=t.length,r=n+(i?1:-1);i?r--:++r<o;)if(e(t[r],r,t))return r;return-1}function X(t){return t!=t}function q(t,e,n){for(var i=n-1,o=t.length;++i<o;)if(t[i]===e)return i;return-1}function J(t,e,n){return e==e?q(t,e,n):W(t,X,n)}function K(t,e){for(var n=-1,i=null==t?0:t.length,o=Array(i);++n<i;)o[n]=e(t[n],n,t);return o}function Z(t){return"symbol"==(void 0===t?"undefined":o(t))||B(t)&&m(t)==cn}function Y(t){if("string"==typeof t)return t;if(ke(t))return K(t,Y)+"";if(Z(t))return hn?hn.call(t):"";var e=t+"";return"0"==e&&1/t==-ln?"-0":e}function Q(t,e,n){var i=-1,o=t.length;e<0&&(e=-e>o?0:o+e),(n=n>o?o:n)<0&&(n+=o),o=e>n?0:n-e>>>0,e>>>=0;for(var r=Array(o);++i<o;)r[i]=t[i+e];return r}function $(t,e,n){var i=t.length;return n=void 0===n?i:n,!e&&n>=i?t:Q(t,e,n)}function tt(t,e){for(var n=t.length;n--&&J(e,t[n],0)>-1;);return n}function et(t,e){for(var n=-1,i=t.length;++n<i&&J(e,t[n],0)>-1;);return n}function nt(t){return t.split("")}function it(t){return fn.test(t)}function ot(t){return t.match(Bn)||[]}function rt(t){return it(t)?ot(t):nt(t)}function at(t){return null==t?"":Y(t)}function st(t,e,n){if((t=at(t))&&(n||void 0===e))return t.replace(_n,"");if(!t||!(e=Y(e)))return t;var i=rt(t),o=rt(e);return $(i,et(i,o),tt(i,o)+1).join("")}function ct(t){return(t=(t=(t=t.toString().replace(Nn,"")).match(xn)[2].replace(" ",""))?t.split(wn):[]).map(function(t){return st(t.replace(Rn,""))})}function lt(t,e){var n={};z(t,function(t,e){function i(e,n){var i=K(o,function(t){return e[t]});i.push(n),d(t).apply(null,i)}var o,r=f(t),a=!r&&1===t.length||r&&0===t.length;if(ke(t))o=t.slice(0,-1),t=t[t.length-1],n[e]=o.concat(o.length>0?i:t);else if(a)n[e]=t;else{if(o=ct(t),0===t.length&&!r&&0===o.length)throw new Error("autoInject task functions require explicit parameters.");r||o.pop(),n[e]=o.concat(i)}}),sn(n,e)}function ut(){this.head=this.tail=null,this.length=0}function ht(t,e){t.length=1,t.head=t.tail=e}function ft(t,e,n){function i(t,e,n){if(null!=n&&"function"!=typeof n)throw new Error("task callback must be a function");if(u.started=!0,ke(t)||(t=[t]),0===t.length&&u.idle())return se(function(){u.drain()});for(var i=0,o=t.length;i<o;i++){var r={data:t[i],callback:n||S};e?u._tasks.unshift(r):u._tasks.push(r)}c||(c=!0,se(function(){c=!1,u.process()}))}function o(t){return function(e){a-=1;for(var n=0,i=t.length;n<i;n++){var o=t[n],r=J(s,o,0);0===r?s.shift():r>0&&s.splice(r,1),o.callback.apply(o,arguments),null!=e&&u.error(e,o.data)}a<=u.concurrency-u.buffer&&u.unsaturated(),u.idle()&&u.drain(),u.process()}}if(null==e)e=1;else if(0===e)throw new Error("Concurrency must not be zero");var r=d(t),a=0,s=[],c=!1,l=!1,u={_tasks:new ut,concurrency:e,payload:n,saturated:S,unsaturated:S,buffer:e/4,empty:S,drain:S,error:S,started:!1,paused:!1,push:function(t,e){i(t,!1,e)},kill:function(){u.drain=S,u._tasks.empty()},unshift:function(t,e){i(t,!0,e)},remove:function(t){u._tasks.remove(t)},process:function(){if(!l){for(l=!0;!u.paused&&a<u.concurrency&&u._tasks.length;){var t=[],e=[],n=u._tasks.length;u.payload&&(n=Math.min(n,u.payload));for(var i=0;i<n;i++){var c=u._tasks.shift();t.push(c),s.push(c),e.push(c.data)}a+=1,0===u._tasks.length&&u.empty(),a===u.concurrency&&u.saturated();var h=A(o(t));r(e,h)}l=!1}},length:function(){return u._tasks.length},running:function(){return a},workersList:function(){return s},idle:function(){return u._tasks.length+a===0},pause:function(){u.paused=!0},resume:function(){!1!==u.paused&&(u.paused=!1,se(u.process))}};return u}function dt(t,e){return ft(t,1,e)}function gt(t,e,n,i){i=T(i||S);var o=d(n);Mn(t,function(t,n,i){o(e,t,function(t,n){e=n,i(t)})},function(t){i(t,e)})}function pt(){var t=K(arguments,d);return function(){var e=r(arguments),n=this,i=e[e.length-1];"function"==typeof i?e.pop():i=S,gt(t,e,function(t,e,i){e.apply(n,t.concat(function(t){var e=r(arguments,1);i(t,e)}))},function(t,e){i.apply(n,[t].concat(e))})}}function vt(t){return t}function mt(t,e){return function(n,i,o,r){r=r||S;var a,s=!1;n(i,function(n,i,r){o(n,function(i,o){i?r(i):t(o)&&!a?(s=!0,a=e(!0,n),r(null,xe)):r()})},function(t){t?r(t):r(null,s?a:e(!1))})}}function bt(t,e){return e}function yt(t){return function(e){var n=r(arguments,1);n.push(function(e){var n=r(arguments,1);"object"==("undefined"==typeof console?"undefined":o(console))&&(e?console.error&&console.error(e):console[t]&&H(n,function(e){console[t](e)}))}),d(e).apply(null,n)}}function Ct(t,e,n){function i(t){if(t)return n(t);var e=r(arguments,1);e.push(o),s.apply(this,e)}function o(t,e){return t?n(t):e?void a(i):n(null)}n=A(n||S);var a=d(t),s=d(e);o(null,!0)}function St(t,e,n){n=A(n||S);var i=d(t);i(function t(o){if(o)return n(o);var a=r(arguments,1);return e.apply(this,a)?i(t):void n.apply(null,[null].concat(a))})}function Tt(t,e,n){St(t,function(){return!e.apply(this,arguments)},n)}function It(t,e,n){function i(t){return t?n(t):void a(o)}function o(t,e){return t?n(t):e?void r(i):n(null)}n=A(n||S);var r=d(e),a=d(t);a(o)}function Bt(t){return function(e,n,i){return t(e,i)}}function _t(t,e,n){$e(t,Bt(d(e)),n)}function xt(t,e,n,i){L(e)(t,Bt(d(n)),i)}function wt(t){return f(t)?t:oe(function(e,n){var i=!0;e.push(function(){var t=arguments;i?se(function(){n.apply(null,t)}):n.apply(null,t)}),t.apply(this,e),i=!1})}function Rt(t){return!t}function Nt(t){return function(e){return null==e?void 0:e[t]}}function Mt(t,e,n,i){var o=new Array(e.length);t(e,function(t,e,i){n(t,function(t,n){o[e]=!!n,i(t)})},function(t){if(t)return i(t);for(var n=[],r=0;r<e.length;r++)o[r]&&n.push(e[r]);i(null,n)})}function Ft(t,e,n,i){var o=[];t(e,function(t,e,i){n(t,function(n,r){n?i(n):(r&&o.push({index:e,value:t}),i())})},function(t){t?i(t):i(null,K(o.sort(function(t,e){return t.index-e.index}),Nt("value")))})}function Pt(t,e,n,i){(C(e)?Mt:Ft)(t,e,d(n),i||S)}function Et(t,e){var n=A(e||S),i=d(wt(t));(function t(e){return e?n(e):void i(t)})()}function kt(t,e,n,i){i=T(i||S);var o={},r=d(n);O(t,e,function(t,e,n){r(t,e,function(t,i){return t?n(t):(o[e]=i,void n())})},function(t){i(t,o)})}function At(t,e){return e in t}function Lt(t,e){var n=Object.create(null),i=Object.create(null);e=e||vt;var o=d(t),a=oe(function(t,a){var s=e.apply(null,t);At(n,s)?se(function(){a.apply(null,n[s])}):At(i,s)?i[s].push(a):(i[s]=[a],o.apply(null,t.concat(function(){var t=r(arguments);n[s]=t;var e=i[s];delete i[s];for(var o=0,a=e.length;o<a;o++)e[o].apply(null,t)})))});return a.memo=n,a.unmemoized=t,a}function Ot(t,e,n){n=n||S;var i=C(e)?[]:{};t(e,function(t,e,n){d(t)(function(t,o){arguments.length>2&&(o=r(arguments,1)),i[e]=o,n(t)})},function(t){n(t,i)})}function Dt(t,e){Ot($e,t,e)}function jt(t,e,n){Ot(L(e),t,n)}function Gt(t,e){if(e=T(e||S),!ke(t))return e(new TypeError("First argument to race must be an array of functions"));if(!t.length)return e();for(var n=0,i=t.length;n<i;n++)d(t[n])(e)}function Vt(t,e,n,i){gt(r(t).reverse(),e,n,i)}function Ut(t){var e=d(t);return oe(function(t,n){return t.push(function(t,e){var i;t?n(null,{error:t}):(i=arguments.length<=2?e:r(arguments,1),n(null,{value:i}))}),e.apply(this,t)})}function Ht(t){var e;return ke(t)?e=K(t,Ut):(e={},z(t,function(t,n){e[n]=Ut.call(this,t)})),e}function zt(t,e,n,i){Pt(t,e,function(t,e){n(t,function(t,n){e(t,!n)})},i)}function Wt(t){return function(){return t}}function Xt(t,e,n){var i=5,r=0,a={times:i,intervalFunc:Wt(r)};if(arguments.length<3&&"function"==typeof t?(n=e||S,e=t):(function(t,e){if("object"==(void 0===e?"undefined":o(e)))t.times=+e.times||i,t.intervalFunc="function"==typeof e.interval?e.interval:Wt(+e.interval||r),t.errorFilter=e.errorFilter;else{if("number"!=typeof e&&"string"!=typeof e)throw new Error("Invalid arguments for async.retry");t.times=+e||i}}(a,t),n=n||S),"function"!=typeof e)throw new Error("Invalid arguments for async.retry");var s=d(e),c=1;(function t(){s(function(e){e&&c++<a.times&&("function"!=typeof a.errorFilter||a.errorFilter(e))?setTimeout(t,a.intervalFunc(c)):n.apply(null,arguments)})})()}function qt(t,e){Ot(Mn,t,e)}function Jt(t,e,n){function i(t,e){var n=t.criteria,i=e.criteria;return n<i?-1:n>i?1:0}var o=d(e);tn(t,function(t,e){o(t,function(n,i){return n?e(n):void e(null,{value:t,criteria:i})})},function(t,e){return t?n(t):void n(null,K(e.sort(i),Nt("value")))})}function Kt(t,e,n){var i=d(t);return oe(function(o,r){var a,s=!1;o.push(function(){s||(r.apply(null,arguments),clearTimeout(a))}),a=setTimeout(function(){var e=t.name||"anonymous",i=new Error('Callback function "'+e+'" timed out.');i.code="ETIMEDOUT",n&&(i.info=n),s=!0,r(i)},e),i.apply(null,o)})}function Zt(t,e,n,i){for(var o=-1,r=hi(ui((e-t)/(n||1)),0),a=Array(r);r--;)a[i?r:++o]=t,t+=n;return a}function Yt(t,e,n,i){var o=d(n);nn(Zt(0,t,1),e,o,i)}function Qt(t,e,n,i){arguments.length<=3&&(i=n,n=e,e=ke(t)?[]:{}),i=T(i||S);var o=d(n);$e(t,function(t,n,i){o(e,t,n,i)},function(t){i(t,e)})}function $t(t,e){var n,i=null;e=e||S,Vn(t,function(t,e){d(t)(function(t,o){n=arguments.length>2?r(arguments,1):o,i=t,e(!t)})},function(){e(i,n)})}function te(t){return function(){return(t.unmemoized||t).apply(null,arguments)}}function ee(t,e,n){n=A(n||S);var i=d(e);if(!t())return n(null);i(function e(o){if(o)return n(o);if(t())return i(e);var a=r(arguments,1);n.apply(null,[null].concat(a))})}function ne(t,e,n){ee(function(){return!t.apply(this,arguments)},e,n)}var ie=function(t){var e=r(arguments,1);return function(){var n=r(arguments);return t.apply(null,e.concat(n))}},oe=function(t){return function(){var e=r(arguments),n=e.pop();t.call(this,e,n)}},re="function"==typeof setImmediate&&setImmediate,ae="object"==(void 0===t?"undefined":o(t))&&"function"==typeof t.nextTick,se=c(re?setImmediate:ae?t.nextTick:s),ce="function"==typeof Symbol,le="object"==(void 0===i?"undefined":o(i))&&i&&i.Object===Object&&i,ue="object"==("undefined"==typeof self?"undefined":o(self))&&self&&self.Object===Object&&self,he=le||ue||Function("return this")(),fe=he.Symbol,de=Object.prototype,ge=de.hasOwnProperty,pe=de.toString,ve=fe?fe.toStringTag:void 0,me=Object.prototype.toString,be="[object Null]",ye="[object Undefined]",Ce=fe?fe.toStringTag:void 0,Se="[object AsyncFunction]",Te="[object Function]",Ie="[object GeneratorFunction]",Be="[object Proxy]",_e=9007199254740991,xe={},we="function"==typeof Symbol&&Symbol.iterator,Re=function(t){return we&&t[we]&&t[we]()},Ne="[object Arguments]",Me=Object.prototype,Fe=Me.hasOwnProperty,Pe=Me.propertyIsEnumerable,Ee=_(function(){return arguments}())?_:function(t){return B(t)&&Fe.call(t,"callee")&&!Pe.call(t,"callee")},ke=Array.isArray,Ae="object"==(void 0===n?"undefined":o(n))&&n&&!n.nodeType&&n,Le=Ae&&"object"==(void 0===e?"undefined":o(e))&&e&&!e.nodeType&&e,Oe=Le&&Le.exports===Ae?he.Buffer:void 0,De=(Oe?Oe.isBuffer:void 0)||function(){return!1},je=9007199254740991,Ge=/^(?:0|[1-9]\d*)$/,Ve={};Ve["[object Float32Array]"]=Ve["[object Float64Array]"]=Ve["[object Int8Array]"]=Ve["[object Int16Array]"]=Ve["[object Int32Array]"]=Ve["[object Uint8Array]"]=Ve["[object Uint8ClampedArray]"]=Ve["[object Uint16Array]"]=Ve["[object Uint32Array]"]=!0,Ve["[object Arguments]"]=Ve["[object Array]"]=Ve["[object ArrayBuffer]"]=Ve["[object Boolean]"]=Ve["[object DataView]"]=Ve["[object Date]"]=Ve["[object Error]"]=Ve["[object Function]"]=Ve["[object Map]"]=Ve["[object Number]"]=Ve["[object Object]"]=Ve["[object RegExp]"]=Ve["[object Set]"]=Ve["[object String]"]=Ve["[object WeakMap]"]=!1;var Ue="object"==(void 0===n?"undefined":o(n))&&n&&!n.nodeType&&n,He=Ue&&"object"==(void 0===e?"undefined":o(e))&&e&&!e.nodeType&&e,ze=He&&He.exports===Ue&&le.process,We=function(){try{return ze&&ze.binding&&ze.binding("util")}catch(t){}}(),Xe=We&&We.isTypedArray,qe=Xe?function(t){return function(e){return t(e)}}(Xe):function(t){return B(t)&&y(t.length)&&!!Ve[m(t)]},Je=Object.prototype.hasOwnProperty,Ke=Object.prototype,Ze=function(t,e){return function(n){return t(e(n))}}(Object.keys,Object),Ye=Object.prototype.hasOwnProperty,Qe=D(O,1/0),$e=function(t,e,n){(C(t)?j:Qe)(t,d(e),n)},tn=G(V),en=g(tn),nn=U(V),on=D(nn,1),rn=g(on),an=function(t){return function(e,n,i){for(var o=-1,r=Object(e),a=i(e),s=a.length;s--;){var c=a[t?s:++o];if(!1===n(r[c],c,r))break}return e}}(),sn=function(t,e,n){function i(t,e){v.push(function(){c(t,e)})}function o(){if(0===v.length&&0===f)return n(null,h);for(;v.length&&f<e;){v.shift()()}}function a(t,e){var n=p[t];n||(n=p[t]=[]),n.push(e)}function s(t){H(p[t]||[],function(t){t()}),o()}function c(t,e){if(!g){var i=A(function(e,i){if(f--,arguments.length>2&&(i=r(arguments,1)),e){var o={};z(h,function(t,e){o[e]=t}),o[t]=i,g=!0,p=Object.create(null),n(e,o)}else h[t]=i,s(t)});f++;var o=d(e[e.length-1]);e.length>1?o(h,i):o(i)}}function l(e){var n=[];return z(t,function(t,i){ke(t)&&J(t,e,0)>=0&&n.push(i)}),n}"function"==typeof e&&(n=e,e=null),n=T(n||S);var u=M(t).length;if(!u)return n(null);e||(e=u);var h={},f=0,g=!1,p=Object.create(null),v=[],m=[],b={};z(t,function(e,n){if(!ke(e))return i(n,[e]),void m.push(n);var o=e.slice(0,e.length-1),r=o.length;return 0===r?(i(n,e),void m.push(n)):(b[n]=r,void H(o,function(s){if(!t[s])throw new Error("async.auto task `"+n+"` has a non-existent dependency `"+s+"` in "+o.join(", "));a(s,function(){0===--r&&i(n,e)})}))}),function(){for(var t=0;m.length;)t++,H(l(m.pop()),function(t){0==--b[t]&&m.push(t)});if(t!==u)throw new Error("async.auto cannot execute tasks due to a recursive dependency")}(),o()},cn="[object Symbol]",ln=1/0,un=fe?fe.prototype:void 0,hn=un?un.toString:void 0,fn=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]"),dn="\\ud800-\\udfff",gn="["+dn+"]",pn="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",vn="\\ud83c[\\udffb-\\udfff]",mn="[^"+dn+"]",bn="(?:\\ud83c[\\udde6-\\uddff]){2}",yn="[\\ud800-\\udbff][\\udc00-\\udfff]",Cn="(?:"+pn+"|"+vn+")"+"?",Sn="[\\ufe0e\\ufe0f]?",Tn=Sn+Cn+("(?:\\u200d(?:"+[mn,bn,yn].join("|")+")"+Sn+Cn+")*"),In="(?:"+[mn+pn+"?",pn,bn,yn,gn].join("|")+")",Bn=RegExp(vn+"(?="+vn+")|"+In+Tn,"g"),_n=/^\s+|\s+$/g,xn=/^(?:async\s+)?(function)?\s*[^\(]*\(\s*([^\)]*)\)/m,wn=/,/,Rn=/(=.+)?(\s*)$/,Nn=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm;ut.prototype.removeLink=function(t){return t.prev?t.prev.next=t.next:this.head=t.next,t.next?t.next.prev=t.prev:this.tail=t.prev,t.prev=t.next=null,this.length-=1,t},ut.prototype.empty=function(){for(;this.head;)this.shift();return this},ut.prototype.insertAfter=function(t,e){e.prev=t,e.next=t.next,t.next?t.next.prev=e:this.tail=e,t.next=e,this.length+=1},ut.prototype.insertBefore=function(t,e){e.prev=t.prev,e.next=t,t.prev?t.prev.next=e:this.head=e,t.prev=e,this.length+=1},ut.prototype.unshift=function(t){this.head?this.insertBefore(this.head,t):ht(this,t)},ut.prototype.push=function(t){this.tail?this.insertAfter(this.tail,t):ht(this,t)},ut.prototype.shift=function(){return this.head&&this.removeLink(this.head)},ut.prototype.pop=function(){return this.tail&&this.removeLink(this.tail)},ut.prototype.toArray=function(){for(var t=Array(this.length),e=this.head,n=0;n<this.length;n++)t[n]=e.data,e=e.next;return t},ut.prototype.remove=function(t){for(var e=this.head;e;){var n=e.next;t(e)&&this.removeLink(e),e=n}return this};var Mn=D(O,1),Fn=function(){return pt.apply(null,r(arguments).reverse())},Pn=Array.prototype.concat,En=function(t,e,n,i){i=i||S;var o=d(n);nn(t,e,function(t,e){o(t,function(t){return t?e(t):e(null,r(arguments,1))})},function(t,e){for(var n=[],o=0;o<e.length;o++)e[o]&&(n=Pn.apply(n,e[o]));return i(t,n)})},kn=D(En,1/0),An=D(En,1),Ln=function(){var t=r(arguments),e=[null].concat(t);return function(){return arguments[arguments.length-1].apply(this,e)}},On=G(mt(vt,bt)),Dn=U(mt(vt,bt)),jn=D(Dn,1),Gn=yt("dir"),Vn=D(xt,1),Un=G(mt(Rt,Rt)),Hn=U(mt(Rt,Rt)),zn=D(Hn,1),Wn=G(Pt),Xn=U(Pt),qn=D(Xn,1),Jn=function(t,e,n,i){i=i||S;var o=d(n);nn(t,e,function(t,e){o(t,function(n,i){return n?e(n):e(null,{key:i,val:t})})},function(t,e){for(var n={},o=Object.prototype.hasOwnProperty,r=0;r<e.length;r++)if(e[r]){var a=e[r].key,s=e[r].val;o.call(n,a)?n[a].push(s):n[a]=[s]}return i(t,n)})},Kn=D(Jn,1/0),Zn=D(Jn,1),Yn=yt("log"),Qn=D(kt,1/0),$n=D(kt,1),ti=c(ae?t.nextTick:re?setImmediate:s),ei=function(t,e){var n=d(t);return ft(function(t,e){n(t[0],e)},e,1)},ni=function(t,e){var n=ei(t,e);return n.push=function(t,e,i){if(null==i&&(i=S),"function"!=typeof i)throw new Error("task callback must be a function");if(n.started=!0,ke(t)||(t=[t]),0===t.length)return se(function(){n.drain()});e=e||0;for(var o=n._tasks.head;o&&e>=o.priority;)o=o.next;for(var r=0,a=t.length;r<a;r++){var s={data:t[r],priority:e,callback:i};o?n._tasks.insertBefore(o,s):n._tasks.push(s)}se(n.process)},delete n.unshift,n},ii=G(zt),oi=U(zt),ri=D(oi,1),ai=function(t,e){e||(e=t,t=null);var n=d(e);return oe(function(e,i){function o(t){n.apply(null,e.concat(t))}t?Xt(t,o,i):Xt(o,i)})},si=G(mt(Boolean,vt)),ci=U(mt(Boolean,vt)),li=D(ci,1),ui=Math.ceil,hi=Math.max,fi=D(Yt,1/0),di=D(Yt,1),gi=function(t,e){function n(e){var n=d(t[o++]);e.push(A(i)),n.apply(null,e)}function i(i){return i||o===t.length?e.apply(null,arguments):void n(r(arguments,1))}if(e=T(e||S),!ke(t))return e(new Error("First argument to waterfall must be an array of functions"));if(!t.length)return e();var o=0;n([])},pi={apply:ie,applyEach:en,applyEachSeries:rn,asyncify:l,auto:sn,autoInject:lt,cargo:dt,compose:Fn,concat:kn,concatLimit:En,concatSeries:An,constant:Ln,detect:On,detectLimit:Dn,detectSeries:jn,dir:Gn,doDuring:Ct,doUntil:Tt,doWhilst:St,during:It,each:_t,eachLimit:xt,eachOf:$e,eachOfLimit:O,eachOfSeries:Mn,eachSeries:Vn,ensureAsync:wt,every:Un,everyLimit:Hn,everySeries:zn,filter:Wn,filterLimit:Xn,filterSeries:qn,forever:Et,groupBy:Kn,groupByLimit:Jn,groupBySeries:Zn,log:Yn,map:tn,mapLimit:nn,mapSeries:on,mapValues:Qn,mapValuesLimit:kt,mapValuesSeries:$n,memoize:Lt,nextTick:ti,parallel:Dt,parallelLimit:jt,priorityQueue:ni,queue:ei,race:Gt,reduce:gt,reduceRight:Vt,reflect:Ut,reflectAll:Ht,reject:ii,rejectLimit:oi,rejectSeries:ri,retry:Xt,retryable:ai,seq:pt,series:qt,setImmediate:se,some:si,someLimit:ci,someSeries:li,sortBy:Jt,timeout:Kt,times:fi,timesLimit:Yt,timesSeries:di,transform:Qt,tryEach:$t,unmemoize:te,until:ne,waterfall:gi,whilst:ee,all:Un,allLimit:Hn,allSeries:zn,any:si,anyLimit:ci,anySeries:li,find:On,findLimit:Dn,findSeries:jn,forEach:_t,forEachSeries:Vn,forEachLimit:xt,forEachOf:$e,forEachOfSeries:Mn,forEachOfLimit:O,inject:gt,foldl:gt,foldr:Vt,select:Wn,selectLimit:Xn,selectSeries:qn,wrapSync:l};n.default=pi,n.apply=ie,n.applyEach=en,n.applyEachSeries=rn,n.asyncify=l,n.auto=sn,n.autoInject=lt,n.cargo=dt,n.compose=Fn,n.concat=kn,n.concatLimit=En,n.concatSeries=An,n.constant=Ln,n.detect=On,n.detectLimit=Dn,n.detectSeries=jn,n.dir=Gn,n.doDuring=Ct,n.doUntil=Tt,n.doWhilst=St,n.during=It,n.each=_t,n.eachLimit=xt,n.eachOf=$e,n.eachOfLimit=O,n.eachOfSeries=Mn,n.eachSeries=Vn,n.ensureAsync=wt,n.every=Un,n.everyLimit=Hn,n.everySeries=zn,n.filter=Wn,n.filterLimit=Xn,n.filterSeries=qn,n.forever=Et,n.groupBy=Kn,n.groupByLimit=Jn,n.groupBySeries=Zn,n.log=Yn,n.map=tn,n.mapLimit=nn,n.mapSeries=on,n.mapValues=Qn,n.mapValuesLimit=kt,n.mapValuesSeries=$n,n.memoize=Lt,n.nextTick=ti,n.parallel=Dt,n.parallelLimit=jt,n.priorityQueue=ni,n.queue=ei,n.race=Gt,n.reduce=gt,n.reduceRight=Vt,n.reflect=Ut,n.reflectAll=Ht,n.reject=ii,n.rejectLimit=oi,n.rejectSeries=ri,n.retry=Xt,n.retryable=ai,n.seq=pt,n.series=qt,n.setImmediate=se,n.some=si,n.someLimit=ci,n.someSeries=li,n.sortBy=Jt,n.timeout=Kt,n.times=fi,n.timesLimit=Yt,n.timesSeries=di,n.transform=Qt,n.tryEach=$t,n.unmemoize=te,n.until=ne,n.waterfall=gi,n.whilst=ee,n.all=Un,n.allLimit=Hn,n.allSeries=zn,n.any=si,n.anyLimit=ci,n.anySeries=li,n.find=On,n.findLimit=Dn,n.findSeries=jn,n.forEach=_t,n.forEachSeries=Vn,n.forEachLimit=xt,n.forEachOf=$e,n.forEachOfSeries=Mn,n.forEachOfLimit=O,n.inject=gt,n.foldl=gt,n.foldr=Vt,n.select=Wn,n.selectLimit=Xn,n.selectSeries=qn,n.wrapSync=l,Object.defineProperty(n,"__esModule",{value:!0})}),cc._RF.pop()}).call(this,t("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:1}],buffSetting:[function(t,e,n){"use strict";cc._RF.push(e,"cac47T6iqdMX5HqHZ/6VL0M","buffSetting");var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=t("constant").BuffType,a=function(){function t(){o(this,t),this._infoMap={}}return i(t,[{key:"parse",value:function(t){var e=this;Object.values(t).forEach(function(t){var n={};if(t.id){switch(n.id=t.id,t.type){case 1:n.type=r.Weight;break;case 2:n.type=r.Speed;break;case 3:n.type=r.Attack;break;case 4:n.type=r.AttackInterval;break;default:cc.assert(!1," invalid buff type: "+n.type)}n.value=t.value,n.duration=t.duration,n.prefab=t.prefab,e._infoMap[n.id]=n}})}},{key:"getBuffInfo",value:function(t){return this._infoMap[t]}}]),t}();e.exports=a,cc._RF.pop()},{constant:"constant"}],buildingController:[function(t,e,n){"use strict";cc._RF.push(e,"6a759bYX7lPrItmCFZeonjv","buildingController");var i=t("settingMgr"),o=t("helper"),r=t("objectFactory");cc.Class({extends:cc.Component,properties:{buildingSprite:cc.Sprite,baseNode:cc.Node},stopAttack:function(){this.attackMode=!1},startAttack:function(){this.attackMode=!0},onLoad:function(){this.isPlaced=!1,this.canPlace=!0,this.attackHurtRate=1,this.attackMode=!1,this.warningNode=null},start:function(){this.timer=0},setAttackHurtRate:function(t){this.attackHurtRate=t},getBuildingPrefabName:function(){return this.buildingAttr.prefab},getAttackRange:function(){return this.buildingAttr.attRange},getSpriteFrame:function(){return this.buildingSprite.spriteFrame},init:function(t,e){var n=i.getSetting("building"),r=i.getSetting("bullet"),a=n.getBuildingInfo(t);cc.assert(a);var s=r.getBulletInfo(a.bullet),c=cc.loader.getRes("bulletPrefab/"+s.prefab,cc.Prefab);cc.assert(c),this.buildingAttr=a,this.bulletAttr=s,this.bulletPrefab=c,this.towerController=e,this.canShoot=!0,this.schedule(this.resetCoolDown,this.buildingAttr.attInterval),this.attackMode=!0,this.isPlaced=!0,this.lastShootTime=0,this.attackIntervalFix=1;var l=i.getSetting("constant").getValue("BUILDING_ACC_COEF");this.attackFixValue=l;var u=i.getSetting("constant");this.moneyGenInterval=u.getValue("BUILDING_OUTPUT_INTERVAL");var h=o.random(1,1e3*this.moneyGenInterval);this.randomInterval=h/1e3,this.schedule(this.autoMoney,this.randomInterval),this.node.zIndex=-Math.floor(this.node.position.y)},autoMoney:function(){if(this.randomInterval!==this.moneyGenInterval&&(this.randomInterval=this.moneyGenInterval,this.unschedule(this.autoMoney),this.schedule(this.autoMoney,this.moneyGenInterval)),0!==this.buildingID){var t=i.getSetting("buildingLevel").getBuildingLevelInfo(this.buildingAttr.level),e=this.node.getComponent(cc.BoxCollider),n=this.node.parent.convertToWorldSpaceAR(this.node.position.addSelf(e.offset));n.y+=this.node.height/2;var o=Math.floor(t.addGold*this.moneyGenInterval);this.towerController.uiController.generateAutoMoneyTip(n,o),this.towerController.userController.addCoin(o,!1)}},showGreenBase:function(){var t=this.node.getComponent(cc.BoxCollider);this.baseNode.setContentSize(t.size),this.baseNode.setPosition(t.offset),this.baseNode.active=!0,this.baseNode.opacity=155,this.baseNode.color=cc.Color.BLACK.fromHEX("#4ee498")},showRedBase:function(){var t=this.node.getComponent(cc.BoxCollider);this.baseNode.setContentSize(t.size),this.baseNode.setPosition(t.offset),this.baseNode.active=!0,this.baseNode.opacity=155,this.baseNode.color=cc.Color.BLACK.fromHEX("#fc3d3d")},hideBase:function(){this.baseNode.active=!1},showAttackRange:function(t){if(this.rangeNode)this.rangeNode.active=!0;else{var e=this.node.getComponent(cc.BoxCollider),n=cc.loader.getRes("buildingPrefab/circle",cc.Prefab);this.rangeNode=new cc.instantiate(n),this.rangeNode.position=this.rangeNode.position.addSelf(e.offset),this.rangeNode.setContentSize(cc.size(2*t,2*t)),this.rangeNode.parent=this.node,this.rangeNode.color=cc.Color.BLACK.fromHEX("#fc3d3d")}},changeAttackRangeGreen:function(){this.rangeNode&&(this.rangeNode.color=cc.Color.BLACK.fromHEX("#4ee498"))},changeAttackRangeRed:function(){this.rangeNode&&(this.rangeNode.color=cc.Color.BLACK.fromHEX("#fc3d3d"))},hideAttackRange:function(){this.rangeNode&&this.rangeNode.destroy()},showWarning:function(){if(!this.warningNode){var t=this.node.getComponent(cc.BoxCollider),e=cc.loader.getRes("effectPrefab/warning",cc.Prefab);cc.assert(e);var n=cc.instantiate(e);n.parent=this.node,n.position=n.position.addSelf(t.offset),this.warningNode=n}this.warningNode.active=!0},hideWarning:function(){this.warningNode&&(this.warningNode.active=!1)},playWarningAnimation:function(){this.showWarning(),this.warningNode.getComponent(cc.Animation).play()},hide:function(){this.node.active=!1},show:function(){this.node.active=!0},getBuildingID:function(){return this.buildingAttr.id},getBuildingLevel:function(){return this.buildingAttr.level},resetCoolDown:function(){this.canShoot=!0},update:function(t){this.timer+=t,this.attackMode&&this.checkEnemyInRange()},isCanPlace:function(){return this.canPlace},checkEnemyInRange:function(){var t=this;null!=this.towerController&&this.towerController.enemyOnRoad.forEach(function(e){if(!(0!==t.lastShootTime&&t.timer-t.lastShootTime<t.buildingAttr.attInterval*t.attackIntervalFix||e.isFeedFull())){var n=e.node;if(o.calDistance(n.position,t.node.position)<=t.buildingAttr.attRange){var i=r.getObject(t.bulletPrefab);i.position=t.node.position,i.parent=t.towerController.bulletLayer;var a=i.getComponent("bulletController"),s=o.genID();a.init(s,t.buildingAttr.bullet,n,(t.buildingAttr.attack*t.attackHurtRate).toFixed(2),t.towerController),1!==t.attackIntervalFix&&t.playSpeedAttackAnim(),t.towerController.bulletMap[s]=a,t.lastShootTime=t.timer}}})},onCollisionEnter:function(t,e){if("buildingBase"==t.node.group||"roadTile"==t.node.group||"wall"==t.node.group){var n=e.getComponent("buildingController");n.isPlaced||(n.showRedBase(),n.changeAttackRangeRed(),this.canPlace=!1)}else"speedDetect"==t.node.group&&(this.attackIntervalFix=this.attackFixValue,this.node.runAction(cc.scaleBy(.1,1.2)))},playSpeedAttackAnim:function(){this.node.runAction(cc.sequence(cc.scaleTo(.1,1),cc.scaleBy(.2,1.2)))},onCollisionStay:function(t,e){if("buildingBase"==t.node.group||"roadTile"==t.node.group||"wall"==t.node.group){var n=e.getComponent("buildingController");n.isPlaced||(n.showRedBase(),n.changeAttackRangeRed(),this.canPlace=!1)}else"speedDetect"===t.node.group&&(this.attackIntervalFix=this.attackFixValue)},onCollisionExit:function(t,e){if("buildingBase"==t.node.group||"roadTile"==t.node.group||"wall"==t.node.group){var n=e.getComponent("buildingController");n.isPlaced||(n.showGreenBase(),n.changeAttackRangeGreen(),this.canPlace=!0)}else"speedDetect"===t.node.group&&(this.node.stopAllActions(),this.attackIntervalFix=1,this.node.runAction(cc.scaleTo(.1,1)))}}),cc._RF.pop()},{helper:"helper",objectFactory:"objectFactory",settingMgr:"settingMgr"}],buildingLevelSetting:[function(t,e,n){"use strict";cc._RF.push(e,"be095CIfJdC1qFidAMuTvel","buildingLevelSetting");var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(){o(this,t),this._infoMap={}}return i(t,[{key:"parse",value:function(t){var e=this;Object.values(t).forEach(function(t){var n={};t.id&&(n.id=t.id,n.buyPrice=t.buyGold,n.refreshPrice=t.refreshGold,n.addGold=t.addGold,e._infoMap[n.id]=n)})}},{key:"getBuildingLevelInfo",value:function(t){return this._infoMap[t]}},{key:"getInfoMap",value:function(){return this._infoMap}}]),t}();e.exports=r,cc._RF.pop()},{}],buildingPanelController:[function(t,e,n){"use strict";cc._RF.push(e,"88b11FOLHpOVJNB829X6Dxy","buildingPanelController");var i=t("uiController"),o=(t("settingMgr"),t("buildingController")),r=t("userController");cc.Class({extends:cc.Component,properties:{text:cc.Label,buildingIcon:cc.Sprite,uiController:i,buildingController:o,userController:r},onEnable:function(){},share:function(){cc.log("buildingPanelController Share")},close:function(){this.node.active=!1}}),cc._RF.pop()},{buildingController:"buildingController",settingMgr:"settingMgr",uiController:"uiController",userController:"userController"}],buildingSetting:[function(t,e,n){"use strict";cc._RF.push(e,"f83bcxnFZVMSqrZIL8ziDZ8","buildingSetting");var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(){o(this,t),this._buldingInfoMap={}}return i(t,[{key:"parse",value:function(t){var e=this;cc.assert(Array.isArray(t)),t.forEach(function(t){var n={};t.id&&(n.id=t.id,n.level=t.level,n.name=t.name,n.attack=t.attack,n.attRange=t.attRange,n.attInterval=t.attInterval,n.bullet=t.bullet,n.prefab=t.prefab,n.sciLvl=t.sciLvl,n.next=t.nextBuilding,e._buldingInfoMap[n.id]=n)})}},{key:"getBuildingInfo",value:function(t){return this._buldingInfoMap[t]}}]),t}();e.exports=r,cc._RF.pop()},{}],bulletController:[function(t,e,n){"use strict";cc._RF.push(e,"7de2ddXkhZKS6e9os3oBtUs","bulletController");var i=t("helper"),o=t("settingMgr");cc.Class({extends:cc.Component,init:function(t,e,n,i,r){var a=o.getSetting("bullet").getBulletInfo(e);cc.assert(a),this.id=t,this.bulletAttr=a,this.bulletType=a.type,this.hurt=i,this.target=n,this.targetController=n.getComponent("enemyController"),this.towerController=r,this.hit=!1,this.buff=a.buff,this.buffPosibility=a.buffPosibility},update:function(t){var e=i.getVectorRad(this.node.position,this.targetController.getHitPoint()),n=cc.misc.radiansToDegrees(e);this.node.angle=n,this.node.position=i.getPointOnCycle(e,this.bulletAttr.speed*t,this.node.position)}}),cc._RF.pop()},{helper:"helper",settingMgr:"settingMgr"}],bulletSetting:[function(t,e,n){"use strict";cc._RF.push(e,"130a0uLQ91O44e3YHMbP4aj","bulletSetting");var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=t("constant").BulletType,a=function(){function t(){o(this,t),this._infoMap={}}return i(t,[{key:"parse",value:function(t){var e=this;Object.values(t).forEach(function(t){var n={};if(t.id){n.id=t.id;var i=t.type;switch(i){case 1:n.type=r.Normal;break;case 2:n.type=r.Range;break;default:cc.assert(!1," invalid bullet type: "+i)}n.speed=t.speed,n.prefab=t.prefab,n.explodePrefab=t.explodePrefab,n.buff=t.buff,n.buffPosibility=t.buffProb,e._infoMap[n.id]=n}})}},{key:"getBulletInfo",value:function(t){return this._infoMap[t]}}]),t}();e.exports=a,cc._RF.pop()},{constant:"constant"}],candyBagController:[function(t,e,n){"use strict";cc._RF.push(e,"d3526DkbtFN3bC7YXDecOrh","candyBagController");var i=t("userController"),o=t("uiController"),r=t("settingMgr"),a=t("helper");cc.Class({extends:cc.Component,properties:{userController:i,diamond:cc.Label,getTimeText:cc.RichText,uiController:o},onEnable:function(){var t=r.getSetting("constant"),e=r.getSetting("stages");this.maxTimes=t.getValue("AD_GET_DIAMOND_TIMES"),this.stage=this.userController.getStage(),this.info=e.getStageInfo(this.stage);var n=this.userController.getCandyBagRecord(),i="<b>\u4eca\u65e5\u8fd8\u53ef\u5f00\u542f "+(this.maxTimes-n.takeTimes)+" / "+this.maxTimes+" \u6b21 < /b>";this.getTimeText.string=i,this.diamond.string=""+this.info.diamondBox},get:function(){var t=this.userController.getCandyBagRecord();if(a.isToday(t.timeStamp)){if(this.maxTimes<=t.takeTimes)return void this.uiController.generateTip("10005");t.takeTimes++}else t.timeStamp=a.nowUnixSec(),t.takeTimes=1;this.userController.setCandyBagRecord(t),this.userController.saveUserInfo(),this.userController.addDiamond(this.info.diamondBox);var e="<b>\u4eca\u65e5\u8fd8\u53ef\u5f00\u542f "+(this.maxTimes-t.takeTimes)+" / "+this.maxTimes+" \u6b21 < /b>";this.getTimeText.string=e;var n=[];n.push(this.info.diamondBox),this.uiController.generateTip("10001",n)},close:function(){this.node.active=!1}}),cc._RF.pop()},{helper:"helper",settingMgr:"settingMgr",uiController:"uiController",userController:"userController"}],combineController:[function(t,e,n){"use strict";cc._RF.push(e,"30e66wzJXVEease06FPxOl2","combineController");var i=t("settingMgr"),o=t("helper"),r=t("userController"),a=t("constant").Event,s=t("uiController");cc.Class({extends:cc.Component,properties:{uiController:s,userController:r,shopSlotSprite:cc.Sprite,shopSlotLevelLabel:cc.Label,buyPriceLabel:cc.Label,refreshPriceLabel:cc.Label,techTab:cc.Node,buildingTab:cc.Node,techItemPrefab:cc.Prefab,listNode:cc.Node,gridNode:cc.Node,recycleNode:cc.Node,slotPrefab:cc.Prefab,slotCount:cc.Integer,refreshButton:cc.Node,techTabToggle:cc.Toggle,buildingTabToggle:cc.Toggle},initEvent:function(){this.node.on(a.TechInfoChange,this.techInfoChange,this),this.node.on(a.StageChange,this.stageChange,this)},init:function(t){var e=this,n=i.getSetting("building");this.allBuildingList=[],Object.values(n._buldingInfoMap).forEach(function(t){e.allBuildingList.push(t)}),this.shopBuildingInfo=null,this.shopBuildingLevelInfo=null,this.initSlots(t),this.initScienceTab(t),this.initButton(t),this.initEvent(),this.updateShop()},initButton:function(t){var e=i.getSetting("constant").getValue("REFRESH_SHOW_STAGE_NUM");t.stage<e?this.refreshButton.active=!1:this.refreshButton.active=!0},savePacakgeRecord:function(){var t=[];this.slotControllers.forEach(function(e){var n={};n.buildingID=e.getSlotBuildingID(),t.push(n)}),this.userController.setPackageRecord(t)},stageChange:function(t){this.initScienceTab(t),this.initButton(t)},initScienceTab:function(t){var e=i.getSetting("constant").getValue("TECH_OPEN_STAGE_NUM");if(!(t.stage<e)){var n=t.techInfo;this.listNode.removeAllChildren(),this.techItemControllers=[];for(var o=null,r=0;r<n.length;r++){o=cc.instantiate(this.techItemPrefab),this.listNode.addChild(o);var a=o.getComponent("techItemController");a.init(n[r].id,n[r].level,this.userController,this.uiController),this.techItemControllers.push(a)}}},techInfoChange:function(){for(var t=0;t<this.techItemControllers.length;t++){this.techItemControllers[t].updateInfoCondition()}},initSlots:function(t){this.slotControllers=[];for(var e=null,n=0;n<this.slotCount;n++){(e=cc.instantiate(this.slotPrefab)).active=!0,e.name=e.name+n,e.parent=this.gridNode;var i=e.getComponent("slotController");i.init(n,this.uiController,this.userController),this.slotControllers.push(i),t.packageRecord[n]&&i.updateInfo(t.packageRecord[n].buildingID)}},priceFix:function(t,e){var n=i.getSetting("constant"),o=n.getValue("BUYTIMES_COEF_A"),r=n.getValue("BUYTIMES_COEF_B"),a=n.getValue("BUYTIMES_COEF_C");return Math.floor(t*(e*e*o+e*r+a))},buy:function(){var t=this.shopBuildingLevelInfo.buyPrice,e=this.userController.getBuyRecord(this.shopBuildingLevelInfo.id);if(t=this.priceFix(t,e.num),this.userController.isCoinEnough(t))for(var n=0;n<this.slotControllers.length;n++){var i=this.slotControllers[n];if(i.isEmpty()){this.userController.reduceCoin(t),i.updateInfo(this.shopBuildingInfo.id),this.userController.addBuyRecord(e.id,1),this.updateShop(),this.savePacakgeRecord();break}}},refresh:function(){var t=i.getSetting("constant").getValue("REFRESH_OPEN_STAGE_NUM");if(this.userController.getStage()<t){var e=[];return e.push(t),void this.uiController.generateTip("10201",e)}var n=this.shopBuildingLevelInfo.refreshPrice,o=this.userController.getBuyRecord(this.shopBuildingLevelInfo.id);n=this.priceFix(n,o.num),this.userController.isCoinEnough(n)&&(this.userController.reduceCoin(n),this.updateShop())},updateShop:function(){for(var t=i.getSetting("buildingLevel"),e=this.userController.getTechInfo(2),n=this.userController.getTechInfo(3),r=this.userController.getTechInfo(4),a=i.getSetting("science"),s=a.getScienceLevelInfo(n.id,n.level),c=a.getScienceLevelInfo(r.id,r.level),l=[],u=0;u<this.allBuildingList.length;u++){var h=this.allBuildingList[u];h.sciLvl<=e.level&&h.level>=s.value&&h.level<=c.value&&l.push(h)}var f=l[o.random(0,l.length)],d=t.getBuildingLevelInfo(f.level);this.shopBuildingInfo=f,this.shopBuildingLevelInfo=d,this.shopSlotLevelLabel.string=f.level,this.setSpriteFrame(this.shopSlotSprite,f.prefab);var g=this.userController.getBuyRecord(this.shopBuildingLevelInfo.id);this.buyPriceLabel.string=this.priceFix(d.buyPrice,g.num),this.refreshPriceLabel.string=this.priceFix(d.refreshPrice,g.num)},setSpriteFrame:function(t,e){var n="sprite/building/"+e;n=n.replace("building_","");var i=cc.loader.getRes(n,cc.SpriteFrame);i?t.spriteFrame=i:console.error("SpriteFrame not found, url: "+n)},getTouchSlotGrid:function(t){t=this.gridNode.convertToNodeSpaceAR(t);for(var e=0;e<this.slotControllers.length;e++)if(this.slotControllers[e].node.getBoundingBox().contains(t))return this.slotControllers[e];return null},isTouchRecycleButtton:function(t){return t=this.node.convertToNodeSpaceAR(t),!!this.recycleNode.getBoundingBox().contains(t)},recycleBuilding:function(t){var e=i.getSetting("buildingLevel"),n=i.getSetting("constant"),o=e.getBuildingLevelInfo(t),r=n.getValue("BUILDING_SELL_COEF"),a=Math.floor(r*o.buyPrice);this.userController.addCoin(a)},getSlotController:function(t){return this.slotControllers[t]},clickTabBuilding:function(){this.buildingTab.active=!0,this.techTab.active=!1},clickTabTech:function(){var t=i.getSetting("constant").getValue("TECH_OPEN_STAGE_NUM");if(this.userController.getStage()<t){this.buildingTabToggle.isChecked=!0,this.techTabToggle.isChecked=!1;var e=[];return e.push(t),void this.uiController.generateTip("10101",e)}this.techTab.active=!0,this.buildingTab.active=!1},isBuildingTab:function(){return this.buildingTab.active},putBackBuilding:function(t){for(var e=0;e<this.slotControllers.length;e++){var n=this.slotControllers[e];if(n.isEmpty()){n.updateInfo(t);break}}}}),cc._RF.pop()},{constant:"constant",helper:"helper",settingMgr:"settingMgr",uiController:"uiController",userController:"userController"}],combineEffectController:[function(t,e,n){"use strict";cc._RF.push(e,"ca913wPdClK7atKNVsC+PfP","combineEffectController");var i=t("objectFactory"),o=t("constant").Event;cc.Class({extends:cc.Component,properties:{buildingLeft:cc.Sprite,buildingRight:cc.Sprite},onLoad:function(){this.anim=this.node.getComponent(cc.Animation),this.anim.on("finished",this.onAnimationFinished,this)},init:function(t,e,n){this.buildingLeft.spriteFrame=t,this.buildingRight.spriteFrame=e,this.parentNode=n,this.anim.play()},onAnimationFinished:function(){var t=cc.loader.getRes("effectPrefab/effect_merge2",cc.Prefab);cc.assert(t);var e=i.getObject(t),n=cc.Canvas.instance.node;e.parent=n,e.position=n.convertToNodeSpaceAR(this.node.parent.convertToWorldSpaceAR(this.node.position)),e.getComponent("onAnimationFinish").play(),i.putObject(this.node),this.parentNode.emit(o.CombineFinish)}}),cc._RF.pop()},{constant:"constant",objectFactory:"objectFactory"}],constantSetting:[function(t,e,n){"use strict";cc._RF.push(e,"cc9c65ZPExECJ/ik9KEZJJn","constantSetting");var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(){o(this,t),this._infoMap={}}return i(t,[{key:"parse",value:function(t){var e=this;Object.values(t).forEach(function(t){var n={};t.id&&(n.id=t.id,n.value=t.value,e._infoMap[n.id]=n)})}},{key:"getValue",value:function(t){return this._infoMap[t].value}}]),t}();e.exports=r,cc._RF.pop()},{}],constant:[function(t,e,n){"use strict";cc._RF.push(e,"5c9dbOVJ1VMHokD8LqEW2xy","constant");e.exports={WXCloudEnv:"test-foodstreet-v01",UserInfoStorgeKey:"foodstreet_record",EnemyState:{Idle:"IDLE_STATE",Walk:"WALK_STATE"},BodyShape:{Small:0,Middle:1,Large:2},HealthState:{Level1:0,Level2:1,Level3:2},Direction:{Right:1,Left:2},Event:{EnemyMove:10001,TechInfoChange:10002,StageChange:10003,CombineFinish:10004},BuffType:{Weight:1,Speed:2,Attack:3,AttackInterval:4},BulletType:{Normal:1,Range:2}},cc._RF.pop()},{}],enemyController:[function(t,e,n){"use strict";cc._RF.push(e,"9ce6aZhdRpMHqO2aDS/qkqd","enemyController");var i=t("helper"),o=t("constant"),r=t("settingMgr"),a=t("enemyStateBarController"),s=t("objectFactory"),c=o.Direction,l=o.BodyShape,u=o.BuffType,h=o.BulletType;cc.Class({extends:cc.Component,properties:{stateBar:a,body:cc.Node},onLoad:function(){this.defaultBodyScaleX=this.body.scaleY,this.defaultBodyScaleY=this.body.scaleX},update:function(t){this.buffSpeedDuration>0?this.buffSpeedDuration-t<0?this.buffSpeedDuration=0:this.buffSpeedDuration-=t:(this.buffSpeed=0,this.buffEffectNode&&(s.putObject(this.buffEffectNode),this.buffEffectNode=null))},hurt:function(t){if(this.stateBar.progressChange(t)&&!this.feedFull){this.feedFull=!0;var e=cc.loader.getRes("effectPrefab/bubble",cc.Prefab);cc.assert(e);var n=s.getObject(e);n.parent=this.node,n.getComponent("onAnimationFinish").play()}var i=this.stateBar.getBodyShape();i!==this.bodyShape&&(this.bodyShape=i,this.animation.play(this.clips[this.bodyShape].name).wrapMode=cc.WrapMode.Loop)},stopMove:function(){this.node.pauseAllActions()},startMove:function(){this.move(this.movePath[this.step])},getHitPoint:function(){return this.node.position.add(cc.v2(0,this.boxHeight))},init:function(t,e,n,i,o){this.node.stopAllActions();var a=r.getSetting("enemy").getEnemyInfo(e);cc.assert(a),this.id=t,this.boxHeight=this.node.getComponent(cc.BoxCollider).offset.y,this.towerController=o,this.feedFull=!1,this.reach=!1,this.attribute={},this.attribute.hp=parseFloat(a.hp*i),this.attribute.speed=a.speed,this.buffSpeed=0,this.buffSpeedDuration=0,this.buffEffectNode=null,this.stateBar.init(this.attribute.hp),this.bodyShape=l.Small,this.movePath=n,this.direction=n[0].direction,this.step=0,this.node.opacity=255,this.animation=this.body.getComponent(cc.Animation),this.animation.stop(),this.clips=this.animation.getClips(),this.animation.play(this.clips[this.bodyShape].name).wrapMode=cc.WrapMode.Loop},move:function(t){var e=i.calDistance(this.node.position,t.position);this.node.runAction(cc.sequence(cc.moveTo(e/Math.floor(this.attribute.speed*(1+this.buffSpeed)),t.position),cc.callFunc(function(){t.direction===c.Left?this.body.scaleX=-Math.abs(this.body.scaleX):this.body.scaleX=Math.abs(this.body.scaleX),this.direction=t.direction,this.node.zIndex=-Math.floor(this.node.position.y),this.nextStep()},this)))},nextStep:function(){this.step++,this.step<this.movePath.length?this.move(this.movePath[this.step]):(this.reach=!0,this.node.runAction(cc.fadeOut(1)),this.towerController.onEnemyReach(this))},isFeedFull:function(){return this.feedFull},onCollisionEnter:function(t,e){if("bullet"===t.node.group){var n=t.node.getComponent("bulletController");if(n.target!==this.node)return;if(!n.hit){this.towerController.onBulletHit(n),n.hit=!0,this.body.stopAllActions(),this.direction===c.Left?this.body.scaleX=-Math.abs(this.defaultBodyScaleX):this.body.scaleX=Math.abs(this.defaultBodyScaleX);var i=this.body.scaleX,o=cc.sequence(cc.scaleTo(.1,1.1*i,1.1),cc.scaleTo(.1,i,1));this.body.runAction(o);var a=n.hurt;if(n.buff&&h.Normal===n.bulletType){var l=Math.random(),f=r.getSetting("buff").getBuffInfo(n.buff);if(l<=n.buffPosibility)if(f.type===u.Weight)a+=f.value;else if(f.type===u.Speed)if(0===this.buffSpeed){this.buffSpeed=f.value,this.buffSpeedDuration=f.duration;var d=cc.loader.getRes("buffPrefab/"+f.prefab,cc.Prefab);cc.assert(d),this.buffEffectNode=s.getObject(d),this.buffEffectNode.parent=this.node}else this.buffSpeed=f.value,this.buffSpeedDuration=f.duration;else f.type===u.Attack||(f.type,u.AttackInterval)}this.hurt(a),s.putObject(t.node);var g=cc.loader.getRes("effectPrefab/effect_hit",cc.Prefab);cc.assert(g);var p=s.getObject(g);p.parent=this.towerController.bulletLayer,p.position=this.node.position,p.getComponent("onAnimationFinish").play()}if(n.bulletType===h.Range){var v=cc.loader.getRes(""+n.bulletAttr.explodePrefab,cc.Prefab);cc.assert(v);var m=s.getObject(v);m.parent=this.towerController.bulletLayer,m.position=this.node.position,m.getComponent("explodeController").init(n.bulletAttr,n.hurt)}}else if("explode"===t.node.group){var b=t.node.getComponent("explodeController"),y=b.bulletAttr,C=b.hurt;if(y.buff){var S=Math.random(),T=r.getSetting("buff").getBuffInfo(y.buff);if(S<=y.buffPosibility)if(T.type===u.Weight)C+=T.value;else if(T.type===u.Speed)if(0===this.buffSpeed){this.buffSpeed=T.value,this.buffSpeedDuration=T.duration;var I=cc.loader.getRes("buffPrefab/"+T.prefab,cc.Prefab);cc.assert(I),this.buffEffectNode=s.getObject(I),this.buffEffectNode.parent=this.node}else this.buffSpeed=T.value,this.buffSpeedDuration=T.duration;else T.type===u.Attack||(T.type,u.AttackInterval)}this.hurt(C);var B=cc.loader.getRes("effectPrefab/effect_hit",cc.Prefab);cc.assert(B);var _=s.getObject(B);_.parent=this.towerController.bulletLayer,_.position=this.node.position,_.getComponent("onAnimationFinish").play()}}}),cc._RF.pop()},{constant:"constant",enemyStateBarController:"enemyStateBarController",helper:"helper",objectFactory:"objectFactory",settingMgr:"settingMgr"}],enemyGroupSetting:[function(t,e,n){"use strict";cc._RF.push(e,"404a3TlsypD1KoAVjt3aML0","enemyGroupSetting");var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(){o(this,t),this.groupMap={}}return i(t,[{key:"parse",value:function(t){this.groupMap=t}},{key:"getEnemyGroupArray",value:function(t){return this.groupMap[t].enemyArray}}]),t}();e.exports=r,cc._RF.pop()},{}],enemySetting:[function(t,e,n){"use strict";cc._RF.push(e,"3219f8fFVhKj5liZcd1J+ks","enemySetting");var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(){o(this,t),this._infoMap={}}return i(t,[{key:"parse",value:function(t){var e=this;Object.values(t).forEach(function(t){var n={};t.id&&(n.id=t.id,n.hp=t.HP,n.speed=t.speed,n.prefab=t.prefab,e._infoMap[n.id]=n)})}},{key:"getEnemyInfo",value:function(t){return this._infoMap[t]}}]),t}();e.exports=r,cc._RF.pop()},{}],enemyStateBarController:[function(t,e,n){"use strict";cc._RF.push(e,"e2ff9RVzPRGypsf1Fy0iM1v","enemyStateBarController");var i=t("constant"),o=i.BodyShape,r=i.HealthState;cc.Class({extends:cc.Component,properties:{progressBar:cc.ProgressBar,barSprite:cc.Sprite,healthStateSpriteFrame:[cc.SpriteFrame]},onLoad:function(){},init:function(t){this.currentValue=0,this.maxValue=t,this.bodyShape=o.Small,this.healthState=r.Level1,this.currentProgress=0,this.progressBar.progress=0,this.node.opacity=255,this.refreshBar()},progressChange:function(t){this.currentValue+=parseInt(t),this.bodyShape=this.calBodyShape(this.currentValue),this.healthState=this.calHealthState(this.currentValue);var e=this.formatFloat(this.currentValue/this.maxValue);return this.currentProgress=e,this.refreshBar(),this.currentValue>=this.maxValue&&(this.currentValue=this.maxValue,this.node.runAction(cc.fadeOut(1)),!0)},refreshBar:function(){var t=this.getHealthStateSprite(this.healthState);t&&(this.barSprite.spriteFrame=t),this.progressBar.progress=this.formatFloat(this.currentProgress)},calBodyShape:function(t){var e=this.maxValue/2;return t<e?o.Small:t>=e&&t<this.maxValue?o.Middle:t>=this.maxValue?o.Large:void 0},calHealthState:function(t){var e=this.maxValue/3,n=this.maxValue/3*2;return t<e?r.Level1:t>=e&&t<n?r.Level2:t>=n?r.Level3:void 0},getBodyShape:function(){return this.bodyShape},getHealthStateSprite:function(t){switch(t){case r.Level1:return this.healthStateSpriteFrame[0];case r.Level2:return this.healthStateSpriteFrame[1];case r.Level3:return this.healthStateSpriteFrame[2]}},formatFloat:function(t){return t>1?1:parseFloat(t.toFixed(2))}}),cc._RF.pop()},{constant:"constant"}],explodeController:[function(t,e,n){"use strict";cc._RF.push(e,"c1a72oA04RC5KROke25BZmS","explodeController");var i=t("objectFactory");cc.Class({extends:cc.Component,properties:{},onLoad:function(){this.anim=this.node.getComponent(cc.Animation),this.anim.on("finished",this.onAnimationFinished,this)},init:function(t,e){this.bulletAttr=t,this.hurt=e,this.anim.play()},onAnimationFinished:function(){i.putObject(this.node)}}),cc._RF.pop()},{objectFactory:"objectFactory"}],gameGuide:[function(t,e,n){"use strict";cc._RF.push(e,"beaa3p5eOBAqYNT/sHjhZga","gameGuide");t("async"),t("locator"),t("guideCommand"),cc.Class({extends:cc.Component,properties:{fingerPrefab:cc.Prefab,textPrefab:cc.Prefab,task:cc.String},onLoad:function(){this.node.setContentSize(cc.winSize)},initFingerPrefab:function(){},initTextPrefab:function(){},initMaskPrefab:function(){},close:function(){this.node.active=!1}});cc._RF.pop()},{async:"async",guideCommand:"guideCommand",locator:"locator"}],gameManager:[function(t,e,n){"use strict";cc._RF.push(e,"040f7Kr/b9A25arUC8Floej","gameManager");var i=t("settingMgr"),o=(t("constant"),t("objectFactory")),r=cc.Class({extends:cc.Component,properties:{enabledDebugDraw:cc.Boolean=!1},statics:{instance:null,getInstance:function(){return r.instance}},initPhysis:function(){var t=cc.director.getCollisionManager();t.enabled=!0,t.enabledDebugDraw=this.enabledDebugDraw},initWXEnv:function(){0},onLoad:function(){cc.debug.setDisplayStats(!1),cc.game.addPersistRootNode(this.node),null==r.instance?r.instance=this:r.instance!=this&&this.node.destroy(),i.init(),this.loadRes(),this.initPhysis(),this.initWXEnv(),cc.director.loadScene("MainScene")},loadRes:function(){cc.loader.loadResDir("buffPrefab",cc.Prefab,function(t,e){t?cc.assert(t):e.forEach(function(t){t instanceof cc.Prefab?(console.info("loading buffPrefab:"+t.name),o.buildObjectPool(t,5)):cc.assert("not buffPrefab element: "+t.name)})}),cc.loader.loadResDir("buildingPrefab",cc.Prefab,function(t,e){t?cc.assert(t):e.forEach(function(t){t instanceof cc.Prefab?(console.info("loading buildingPrefab:"+t.name),o.buildObjectPool(t,2)):cc.assert(!1,"not buildingPrefab element "+ +t.name)})}),cc.loader.loadResDir("bulletPrefab",cc.Prefab,function(t,e){t?cc.assert(t):e.forEach(function(t){t instanceof cc.Prefab?(console.info("loading bulletPrefab: "+t.name),o.buildObjectPool(t,5)):cc.assert(!1,"not bulletPrefab element "+ +t.name)})}),cc.loader.loadResDir("effectPrefab",cc.Prefab,function(t,e){t?cc.assert(t):e.forEach(function(t){t instanceof cc.Prefab?(console.info("loading effectPrefab: "+t.name),o.buildObjectPool(t,5)):cc.assert(!1,"not effectPrefab element "+ +t.name)})}),cc.loader.loadResDir("rolePrefab",cc.Prefab,function(t,e){t?cc.assert(t):e.forEach(function(t){t instanceof cc.Prefab?(o.buildObjectPool(t,20),console.info("loading rolePrefab:"+t.name)):cc.assert(!1,"not rolePrefab element "+ +t.name)})}),cc.loader.loadResDir("map",cc.TiledMapAsset,function(t,e){t?cc.assert(t):e.forEach(function(t){t instanceof cc.TiledMapAsset?console.info("loading TiledMapAsset:"+t.name):cc.assert(!1,"not TiledMapAsset element "+ +t.name)})}),cc.loader.loadResDir("map",cc.SpriteAtlas,function(t,e){t?cc.assert(t):e.forEach(function(t){t instanceof cc.SpriteAtlas?console.info("loading SpriteAtlas:"+t.name):cc.assert(!1,"not SpriteAtlas element "+ +t.name)})}),cc.loader.loadResDir("sprite/technology",cc.SpriteFrame,function(t,e){t?cc.assert(t):e.forEach(function(t){t instanceof cc.SpriteFrame?console.info("loading sprite/technology:"+t.name):cc.assert(!1,"not Sprite element "+ +t.name)})}),cc.loader.loadResDir("sprite/building",cc.SpriteFrame,function(t,e){t?cc.assert(t):e.forEach(function(t){t instanceof cc.SpriteFrame?console.info("loading sprite/building:"+t.name):cc.assert(!1,"not Sprite element "+ +t.name)})}),cc.loader.loadResDir("sprite/preload",cc.SpriteFrame,function(t,e){t?cc.assert(t):e.forEach(function(t){t instanceof cc.SpriteFrame?console.info("loading sprite/preload:"+t.name):cc.assert(!1,"not Sprite element "+ +t.name)})})}});cc._RF.pop()},{constant:"constant",objectFactory:"objectFactory",settingMgr:"settingMgr"}],gameScene:[function(t,e,n){"use strict";cc._RF.push(e,"18e79YZngREPqoYGlWkcSPC","gameScene");var i=t("operationController"),o=t("userController");cc.Class({extends:cc.Component,properties:{operationController:i,userController:o},onLoad:function(){this.userController.init(),this.operationController.init(this.userController.getUserInfo())}}),cc._RF.pop()},{operationController:"operationController",userController:"userController"}],guideCommand:[function(t,e,n){"use strict";cc._RF.push(e,"cdb52jZTelDvb4VLQFahEwL","guideCommand");var i={locator:function(t,e,n){var i=e.command.args;t.find(i,function(e){t._targetNode=e,e.once(cc.Node.EventType.TOUCH_END,function(){cc.log("\u5b9a\u4f4d\u8282\u70b9\u88ab\u70b9\u51fb"),n()})})},finger:function(t,e,n){var i=e.command.args;t._targetNode=null,cc.log("\u624b\u6307\u6307\u5b9a\u8282\u70b9\u8fdb\u5165");for(var o=0;o<i.length;o++)t.find(i[o],function(e){t.fingerToNode(e,function(){t._targetNode=e,e.once(cc.Node.EventType.TOUCH_END,function(){cc.log("\u624b\u6307\u6307\u5b9a\u8282\u70b9\u88ab\u70b9\u51fb"),n()})})})},move:function(t,e,n){var i=e.command.args,o=i[0],r=i[1];o=t.findNode(o),r=t.findNode(r),cc.log("fromNode.uuid"+o.uuid+"    targetNode.uuid"+r.uuid),t._fromNode=o,t._targetNode=r,t.focusFromNodeToTargetNode(r,o),t.moveToNode(o,r,function(){r.once(cc.Node.EventType.MOUSE_UP,function(){cc.log("move\u6307\u5b9a\u8282\u70b9\u88ab\u70b9\u51fb"),n()})})},moveToTower:function(t,e,n){var i=e.command.args,o=i[0],r=i[1];o=t.findNode(o),r=t.findNode(r),t._fromNode=o,t._targetNode=r,t.focusFormNodeToTowerNode(o,r),t.moveToNode(o,r,function(){r.once(cc.Node.EventType.MOUSE_UP,function(){cc.log("moveToTower\u6307\u5b9a\u8282\u70b9\u88ab\u70b9\u51fb"),n()})})},textTouch:function(t,e,n){var i=e.command.args;t.showText(i,function(){t.node.once(cc.Node.EventType.TOUCH_END,function(){cc.log("Text\u6307\u5b9a\u8282\u70b9\u88ab\u70b9\u51fb"),n()})})},text:function(t,e,n){var i=e.command.args;t.showTextNoCallBack(i,n)},LOCATOR:"locator",FINGER:"finger",TEXTTOUCH:"textTouch",TEXT:"text",MOVE:"move",MOVETOTOWER:"moveToTower"};e.exports=i,cc._RF.pop()},{}],guideTask:[function(t,e,n){"use strict";cc._RF.push(e,"15220rC2xJOTJhgHk0G7iRS","guideTask");var i=t("guideCommand");e.exports={name:"\u65b0\u624b\u5f15\u5bfc",debug:!0,steps:[{desc:"\u6587\u672c\u63d0\u793a",command:{cmd:i.TEXTTOUCH,args:"\u6b22\u8fce\u6765\u5230\u771f\u9999\u5c0f\u9547\uff01\u6211\u4eec\u9700\u8981\u5efa\u9020\u7f8e\u98df\u9910\u9986,\u6765\u5582\u9971\u524d\u6765\u7684\u987e\u5ba2\u54e6\uff01"},delayTime:1},{desc:"\u6587\u672c\u63d0\u793a",command:{cmd:i.TEXT,args:"\u70b9\u51fb\u8d2d\u4e70\u5efa\u7b51"}},{desc:"\u70b9\u51fb\u8d2d\u4e70\u5efa\u7b51",command:{cmd:i.FINGER,args:["Game > Combine > Building > Buy > Background"]}},{desc:"\u6587\u672c\u63d0\u793a",command:{cmd:i.TEXT,args:"\u518d\u6b21\u70b9\u51fb\u53ef\u4ee5\u7ee7\u7eed\u8d2d\u4e70\u5efa\u7b51"}},{desc:"\u518d\u6b21\u70b9\u51fb\u53ef\u4ee5\u7ee7\u7eed\u8d2d\u4e70\u5efa\u7b51",command:{cmd:i.FINGER,args:["Game > Combine > Building > Buy > Background"]}},{desc:"\u6587\u672c\u63d0\u793a",command:{cmd:i.TEXT,args:"\u8bf7\u62d6\u52a8\u5efa\u7b51\u5230\u5176\u4ed6\u5efa\u7b51\u4e0a\uff0c\u6765\u5408\u6210\u9ad8\u7ea7\u5efa\u7b51"}},{desc:"\u8bf7\u62d6\u52a8\u5efa\u7b51\u5230\u5176\u4ed6\u5efa\u7b51\u4e0a\uff0c\u6765\u5408\u6210\u9ad8\u7ea7\u5efa\u7b51",command:{cmd:i.MOVE,args:["Game > Combine > Building > Grid > gridSlot0","Game > Combine > Building > Grid > gridSlot1"]}},{desc:"\u6587\u672c\u63d0\u793a",command:{cmd:i.TEXT,args:"\u8bf7\u62d6\u52a8\u5efa\u7b51\u5230\u9053\u8def\u4e0a\uff0c\u6765\u5582\u9971\u524d\u6765\u7684\u987e\u5ba2\u54e6\uff01"}},{desc:"\u8bf7\u62d6\u52a8\u5efa\u7b51\u5230\u9053\u8def\u4e0a\uff0c\u6765\u5582\u9971\u524d\u6765\u7684\u987e\u5ba2\u54e6\uff01",command:{cmd:i.MOVETOTOWER,args:["Game > Combine > Building > Grid > gridSlot1","Game > TowerGuide"]}},{desc:"\u6587\u672c\u63d0\u793a",command:{cmd:i.TEXT,args:"\u8bf7\u70b9\u51fb\u5f00\u59cb\u6309\u94ae\uff0c\u6765\u5582\u9971\u524d\u6765\u7684\u987e\u5ba2\u54e6\uff01"}},{desc:"\u70b9\u51fb\u5f00\u59cb",command:{cmd:i.FINGER,args:["UI > start > Background"]}}]},cc._RF.pop()},{guideCommand:"guideCommand"}],helper:[function(t,e,n){"use strict";cc._RF.push(e,"1d522YKHrpBa6nR4oiW0yBR","helper");t("constant").Direction;var i={wxShare:function(t,e,n,i){wx.shareAppMessage({title:t,imageUrl:e,query:i,imageUrlId:n})},wxShowVideoWithPromise:function(){return new Promise(function(t,e){var n=wx.createRewardedVideoAd({adUnitId:"adunit-cb415f5547761860"});wx.showLoading({title:"\u52a0\u8f7d\u4e2d",mask:!0});var i=!1,o=setTimeout(function(){console.log("timeout"),wx.hideLoading({}),t({isEnded:!1,err:"\u62c9\u53d6\u5e7f\u544a\u8d85\u65f6\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5"}),i=!0},1e4);n.load().then(function(){i||(wx.hideLoading({}),clearTimeout(o),n.show())}).catch(function(e){i||(wx.hideLoading({}),clearTimeout(o),"no advertisement"===e.errMsg?t({isEnded:!1,err:"\u4eca\u65e5\u5e7f\u544a\u64ad\u653e\u6b21\u6570\u5df2\u8fbe\u4e0a\u9650"}):t({isEnded:!1,err:"\u62c9\u53d6\u5e7f\u544a\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5"}))}),n.offError(),n.onError(function(t){return console.log(err)}),n.offClose(),n.onClose(function(e){clearTimeout(o),t({isEnded:e&&e.isEnded||void 0===e})})})},isToday:function(t){var e=new Date,n=new Date(1e3*t);return e.setHours(0,0,0,0)===n.setHours(0,0,0,0)},isSameDay:function(t,e){var n=new Date(t),i=new Date(e);return n.setHours(0,0,0,0)===i.setHours(0,0,0,0)},nowUnixSec:function(){return Math.round((new Date).getTime()/1e3)},random:function(t,e){return Math.floor(Math.random()*(e-t))+t},genID:function(){var t=Date.now().toString(36);return t+=Math.random().toString(36).substr(3)},getPointOnCycle:function(t,e,n){return n=n||cc.Vec2.ZERO,cc.Vec2.RIGHT.rotate(t).mulSelf(e).addSelf(n)},getVectorRad:function(t,e){return Math.atan2(e.y-t.y,e.x-t.x)},calRad:function(t,e){var n=e.x-t.x,i=e.y-t.y,o=Math.sqrt(Math.pow(n,2)+Math.pow(i,2));return i>=0?Math.acos(n/o):2*Math.PI-Math.acos(n/o)},calDistance:function(t,e){return e.sub(t).mag()}};e.exports=i,cc._RF.pop()},{constant:"constant"}],loadGuide:[function(t,e,n){"use strict";cc._RF.push(e,"f8ec45vgztPH5tzcIralSDL","loadGuide");var i=t("async");cc.Class({extends:cc.Component,properties:{PREFAB:cc.Prefab,parent:cc.Node,zIndex:0,tasks:[cc.String],userState:0},onLoad:function(){this.userState&&this.loadPrefab()},start:function(){this.runTask()},loadPrefab:function(){try{var t=cc.instantiate(this.PREFAB);t.zIndex=this.zIndex,t.position=cc.v2(0,0),t.parent=this.parent||this.node,this._godGuide=null,this._godGuide=t.getComponent("GodGuide")}catch(t){cc.error(this.PREFAB),cc.error(t)}},runTask:function(){var e=this;console.log(this.tasks),i.eachSeries(this.tasks,function(n,i){var o=t(n);e._godGuide&&(e._godGuide.setTask(o),e._godGuide.run(i))},function(){cc.log("\u4efb\u52a1\u5168\u90e8\u5b8c\u6210")})}}),cc._RF.pop()},{async:"async"}],locator:[function(t,e,n){"use strict";cc._RF.push(e,"2e293ZNVqJNEYkHyZRFajw7","locator");var i={timeout:5e3,parse:function(t){cc.assert(t,"locator string is null");var e=t.split(/[.,//,>,#]/g);return cc.log(e),e.map(function(e){var n=t.indexOf(e);return{symbol:t[n-1]||">",name:e.trim()}})},seekNodeByName:function(t,e){if(!t)return null;if(t.getName()==e)return t;for(var n=t.getChildren(),i=n.length,o=0;o<i;o++){var r=n[o],a=this.seekNodeByName(r,e);if(null!=a)return a}return null},locateNode:function(t,e,n){this.locating||(this.startTime=Date.now(),this.locating=!0);var o=this.parse(e);cc.assert(o&&o.length);for(var r=void 0,a=t,s=0;s<o.length;s++){var c=o[s];switch(c.symbol){case"/":r=a.getChildByName(c.name);break;case".":r=a[c.name];break;case">":r=this.seekNodeByName(a,c.name);break;case"#":r=this.seekNodeByTag(a,c.name)}if(!r){a=null;break}a=r}return a&&a.active&&n?(this.locating=!1,n(null,a)):n&&(Date.now()-this.startTime>this.timeout?n({error:"timeout",locator:e}):setTimeout(function(){i.locateNode(t,e,n)},10)),a},getNodeFullPath:function(t){var e=[],n=t;do{e.unshift(n.name),n=n.parent}while(n&&"Canvas"!==n.name);return e.join("/")}};window.Locator=i,e.exports=i,cc._RF.pop()},{}],losePanelController:[function(t,e,n){"use strict";cc._RF.push(e,"56fedSxXFxIsZc3o7kJn2xR","losePanelController");var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),o=this&&this.__decorate||function(t,e,n,i){var o,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,n,a):o(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var r=cc._decorator,a=r.ccclass,s=r.property,c=(t("../util/Helper"),function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.stageLabel=null,e.helpBtn=null,e}return i(e,t),e.prototype.updateInfo=function(t){this.stageLabel.string=t.toString()},e.prototype.getHelp=function(){cc.log("this.getHelp")},o([s(cc.Label)],e.prototype,"stageLabel",void 0),o([s(cc.Button)],e.prototype,"helpBtn",void 0),e=o([a],e)}(cc.Component));n.default=c,cc._RF.pop()},{"../util/Helper":"helper"}],mapSetting:[function(t,e,n){"use strict";cc._RF.push(e,"2109bg0UVJLtqo6+yridcac","mapSetting");var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(){o(this,t),this._mapSet={}}return i(t,[{key:"parse",value:function(t){var e={};if(t.stage){e.name=t.name,e.stage=t.stage,e.width=t.width,e.height=t.height,e.tileWidth=t.tileWidth,e.tileHeight=t.tileHeight,e.roadMap=t.roadMap,e.obstacleMap=t.obstacleMap;var n=t.entrances;cc.assert(Array.isArray(n)),e.entrancesMap={},e.entranceIndexArray=[],n.forEach(function(t){var n=t.x+t.y*e.width;e.entranceIndexArray.push(n),e.entrancesMap[t.id]=cc.v2(t.x,t.y)}),e.exit=cc.v2(t.exit_point.x,t.exit_point.y),this._mapSet[e.name]=e}}},{key:"getStage",value:function(t){return this._mapSet[t].stage}},{key:"getRoadMap",value:function(t){return this._mapSet[t].roadMap}},{key:"getObstacleMap",value:function(t){return this._mapSet[t].obstacleMap}},{key:"getMapSize",value:function(t){return cc.size(this._mapSet[t].width,this._mapSet[t].height)}},{key:"getTileSize",value:function(t){return cc.size(this._mapSet[t].tileWidth,this._mapSet[t].tileHeight)}},{key:"getWidth",value:function(t){return this._mapSet[t].width}},{key:"getHeight",value:function(t){return this._mapSet[t].height}},{key:"getTileWidth",value:function(t){return this._mapSet[t].tileWidth}},{key:"getTileHeight",value:function(t){return this._mapSet[t].tileHeight}},{key:"getEntrance",value:function(t,e){var n=this._mapSet[t].entrancesMap[e];return cc.v2(n.x,n.y)}},{key:"isEntranceByIndex",value:function(t,e){for(var n=this._mapSet[t].entranceIndexArray,i=0;i<n.length;i++)if(e===n[i])return!0;return!1}},{key:"getExit",value:function(t){return this._mapSet[t].exit}}]),t}();e.exports=r,cc._RF.pop()},{}],modalUI:[function(t,e,n){"use strict";cc._RF.push(e,"bd973c8qEVDKJ1qRYXV3GHv","modalUI"),cc.Class({extends:cc.Component,properties:{mask:cc.Node},onLoad:function(){},onEnable:function(){this.mask.on(cc.Node.EventType.TOUCH_START,function(t){t.stopPropagation()}),this.mask.on(cc.Node.EventType.TOUCH_MOVE,function(t){t.stopPropagation()}),this.mask.on(cc.Node.EventType.TOUCH_END,function(t){t.stopPropagation()}),this.mask.on(cc.Node.EventType.TOUCH_CANCEL,function(t){t.stopPropagation()})},onDisable:function(){this.mask.off(cc.Node.EventType.TOUCH_START,function(t){t.stopPropagation()}),this.mask.off(cc.Node.EventType.TOUCH_END,function(t){t.stopPropagation()}),this.mask.off(cc.Node.EventType.TOUCH_END,function(t){t.stopPropagation()}),this.mask.off(cc.Node.EventType.TOUCH_CANCEL,function(t){t.stopPropagation()})}}),cc._RF.pop()},{}],objectFactory:[function(t,e,n){"use strict";cc._RF.push(e,"aa6fdmlkZhPAJWO9JS9/4dw","objectFactory");var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=new(function(){function t(){o(this,t),this._pools={}}return i(t,[{key:"buildObjectPool",value:function(t,e){for(var n=new cc.NodePool,i=0;i<e;i++){var o=cc.instantiate(t);n.put(o)}this._pools[t.name]=n}},{key:"destroyAllPool",value:function(){var t=this;Object.keys(this._pools).forEach(function(e){t._pools[e].clear()})}},{key:"getObject",value:function(t){var e=this._pools[t.name];if(!e)return null;var n=e.get();return n||(n=cc.instantiate(t),console.info("pool object not enough instantiate new object: "+t.name+" pool size:"+e.size())),n}},{key:"putObject",value:function(t){var e=this._pools[t.name];if(!e)return console.error("putObject object pool not exist. object: "+t.name),void t.destroy();e.put(t)}}]),t}());e.exports=r,cc._RF.pop()},{}],offlinePanelController:[function(t,e,n){"use strict";cc._RF.push(e,"99be5RJehJBQ62f8KpCaGIF","offlinePanelController");var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),o=this&&this.__decorate||function(t,e,n,i){var o,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,n,a):o(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var r=cc._decorator,a=r.ccclass,s=r.property,c=t("../setting/settingMgr"),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.profitLabel=null,e.offlineDurationLabel=null,e.upperLabelNode=null,e}return i(e,t),e.prototype.init=function(t,e){var n=c.getSetting("constant").getValue("OFFLINE_REWARD_TIME_MAX");this.profitLabel.string=t.toString();var i=Math.ceil(e/60);this.offlineDurationLabel.string="<b>\u4f60\u83b7\u5f97"+i+"\u5206\u949f\u79bb\u7ebf\u5956\u52b1</b>",this.upperLabelNode.active=e>=n},o([s(cc.Label)],e.prototype,"profitLabel",void 0),o([s(cc.RichText)],e.prototype,"offlineDurationLabel",void 0),o([s(cc.Node)],e.prototype,"upperLabelNode",void 0),e=o([a],e)}(cc.Component);n.default=l,cc._RF.pop()},{"../setting/settingMgr":"settingMgr"}],onAnimationFinish:[function(t,e,n){"use strict";cc._RF.push(e,"f952cPsLRFJWZ8oIasde+JC","onAnimationFinish");var i=t("objectFactory");cc.Class({extends:cc.Component,properties:{},onLoad:function(){this.anim=this.node.getComponent(cc.Animation),this.anim.on("finished",this.onAnimationFinished,this)},play:function(){this.anim.play()},onAnimationFinished:function(){i.putObject(this.node)}}),cc._RF.pop()},{objectFactory:"objectFactory"}],operationController:[function(t,e,n){"use strict";cc._RF.push(e,"e0e9eA7Ax9B9J6ST+R8H5Av","operationController");var i=t("uiController"),o=(t("objectFactory"),0),r=1,a=2;cc.Class({extends:cc.Component,properties:{combineNode:cc.Node,towerNode:cc.Node,uiController:i,dragBuildingLayer:cc.Node,dragItemPrefab:cc.Prefab,dragItemLayer:cc.Node},onLoad:function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchCancel,this)},init:function(t){this.combineController=this.combineNode.getComponent("combineController"),this.towerController=this.towerNode.getComponent("towerController"),this.combineController.init(t),this.towerController.init(t.stage,t.towerBuildingRecord),this.dragslotController=null,this.dragBuildingController=null,this.dragBuildingNode=null,this.dragItemNode=null,this.lastTileIndex=-1},createDragItem:function(t,e){this.dragItemNode&&(this.dragItemNode.destroy(),this.dragItemNode=null),this.dragItemNode=cc.instantiate(this.dragItemPrefab),this.dragItemNode.parent=this.dragItemLayer,this.dragItemNode.position=this.dragItemLayer.convertToNodeSpaceAR(t),this.dragItemNode.getComponent(cc.Sprite).spriteFrame=e},moveDragItem:function(t){this.dragItemNode.position=this.dragItemLayer.convertToNodeSpaceAR(t)},showDragItem:function(){this.dragItemNode&&(this.dragItemNode.active=!0)},hideDragItem:function(){this.dragItemNode&&(this.dragItemNode.active=!1)},isDragItemExist:function(){return!!this.dragItemNode},destoryDragItem:function(){this.dragItemNode&&(this.dragItemNode.destroy(),this.dragItemNode=null)},createDragBuilding:function(t,e,n){this.dragBuildingNode&&(this.dragBuildingNode.destroy(),this.dragBuildingNode=null);var i=cc.loader.getRes("buildingPrefab/"+e,cc.Prefab);this.dragBuildingNode=cc.instantiate(i),this.dragBuildingNode.parent=this.dragBuildingLayer,this.dragBuildingNode.position=t;var o=this.dragBuildingNode.getComponent("buildingController");o.showGreenBase(),o.showAttackRange(n),o.changeAttackRangeGreen(),this.dragBuildingNode.zIndex=cc.macro.MAX_ZINDEX},moveDragBuilding:function(t){var e=this.towerController.touchPosToTileGridIndex(t);if(e!==this.lastTileIndex){var n=this.towerController.gridIndexToTileMapGridCoord(e),i=this.towerController.tileMapGridCoordToMapNodePos(n),o=this.towerController.mapNodePosToWorldSpaceAR(i);this.dragBuildingNode.position=this.dragBuildingLayer.convertToNodeSpaceAR(o),this.lastTileIndex=e;var r=this.dragBuildingNode.getComponent("buildingController");this.towerController.isRoad(e)?(r.showRedBase(),r.changeAttackRangeRed()):(r.showGreenBase(),r.changeAttackRangeGreen())}},hideDragBuilding:function(){this.dragBuildingNode&&(this.dragBuildingNode.active=!1)},showDragBuilding:function(){this.dragBuildingNode&&(this.dragBuildingNode.active=!0)},isDragBuildingExist:function(){return!!this.dragBuildingNode},destroyDragBuilding:function(){this.dragBuildingNode&&(this.dragBuildingNode.destroy(),this.dragBuildingNode=null)},onTouchStart:function(t){if(this.combineController.isBuildingTab()&&(!this.touchId||this.touchId==t.getID())){this.touchId=t.getID();var e=t.getLocation();if(this.opMode=o,this.towerController.isTowerArea(e)){this.towerController.onTouchStart(e);var n=this.towerController.isTouchBuilding(e);if(!(n&&n.buildingController&&n.index))return;this.opMode=a,this.dragBuildingIndex=n.index,this.dragBuildingController=n.buildingController;var i=this.dragBuildingController.getBuildingPrefabName(),s=this.dragBuildingController.getAttackRange();this.createDragBuilding(n.buildingController.node.position,i,s),this.dragBuildingController.hide(),this.towerController.setDragingState(!0)}else{var c=this.combineController.getTouchSlotGrid(e);if(!c||c.isEmpty())return;this.opMode=r,this.slotController=c;var l=c.getSpriteFrame();this.createDragItem(e,l),this.slotController.hide()}}},onTouchMove:function(t){if(this.combineController.isBuildingTab()&&t.getID()==this.touchId){var e=t.getLocation();if(this.opMode==r)if(this.towerController.isTowerArea(e)){if(this.hideDragItem(),!this.isDragBuildingExist()){var n=this.slotController.getSlotInfo(),i=this.dragBuildingLayer.convertToNodeSpaceAR(e);this.createDragBuilding(i,n.buildingPrefabName,n.buildingAttackRange)}this.showDragBuilding(),this.moveDragBuilding(e)}else this.hideDragBuilding(),this.showDragItem(),this.moveDragItem(e);else if(this.opMode==a)if(this.towerController.isTowerArea(e))this.hideDragItem(),this.showDragBuilding(),this.moveDragBuilding(e);else{if(!this.isDragItemExist()){var o=this.dragBuildingController.getSpriteFrame();this.createDragItem(e,o)}this.hideDragBuilding(),this.showDragItem(),this.moveDragItem(e)}else this.towerController.onTouchMove(e)}},onTouchEnd:function(t){if(this.towerController.onTouchEnd(),this.combineController.isBuildingTab()){var e=t.getLocation();if(this.opMode==r)if(this.towerController.isTowerArea(e)){var n=this.slotController.getSlotInfo().buildingID;this.towerController.placeBuilding(n,this.dragBuildingNode,e)?this.slotController.reset():this.slotController.show(),this.slotController=null,this.destoryDragItem(),this.destroyDragBuilding()}else{if(this.combineController.isTouchRecycleButtton(e))return this.combineController.recycleBuilding(this.slotController.getSlotBuildingLevel()),this.slotController.reset(),this.slotController=null,this.combineController.savePacakgeRecord(),this.destoryDragItem(),void this.destroyDragBuilding();var i=this.combineController.getTouchSlotGrid(e);if(!i)return this.slotController.show(),this.slotController=null,this.destoryDragItem(),void this.destroyDragBuilding();if(i.getIndex()==this.slotController.getIndex())return this.slotController.show(),this.slotController=null,this.destoryDragItem(),void this.destroyDragBuilding();i.combine(this.slotController)?(this.slotController.reset(),this.combineController.savePacakgeRecord()):i.replace(this.slotController)?(this.slotController.reset(),this.combineController.savePacakgeRecord()):this.slotController.show(),this.slotController=null,this.destoryDragItem(),this.destroyDragBuilding()}else if(this.opMode==a)if(this.towerController.isTowerArea(e)){if(this.towerController.isTouchBuildingExceptIndex(e,this.dragBuildingIndex))return this.destoryDragItem(),this.destroyDragBuilding(),this.dragBuildingController.show(),this.dragBuildingController=null,this.towerController.setDragingState(!1),void this.uiController.generateTip("10301");var s=this.dragBuildingController.getBuildingID();this.towerController.placeBuilding(s,this.dragBuildingNode,e)?(this.destoryDragItem(),this.destroyDragBuilding(),this.towerController.removeBuilding(this.dragBuildingIndex),this.dragBuildingController=null,this.towerController.setDragingState(!1)):(this.destoryDragItem(),this.destroyDragBuilding(),this.dragBuildingController.show(),this.dragBuildingController=null,this.towerController.setDragingState(!1))}else{if(this.combineController.isTouchRecycleButtton(e))return this.combineController.recycleBuilding(this.dragBuildingController.getBuildingLevel()),this.destoryDragItem(),this.destroyDragBuilding(),this.towerController.removeBuilding(this.dragBuildingIndex),this.dragBuildingController=null,void this.towerController.setDragingState(!1);var c=this.combineController.getTouchSlotGrid(e);if(!c)return this.destoryDragItem(),this.destroyDragBuilding(),this.dragBuildingController.show(),this.dragBuildingController=null,void this.towerController.setDragingState(!1);if(c.isEmpty()){var l=this.dragBuildingController.getBuildingID();c.updateInfo(l),this.towerController.removeBuilding(this.dragBuildingIndex),this.dragBuildingController=null}else this.dragBuildingController.show();this.destoryDragItem(),this.destroyDragBuilding(),this.dragBuildingController=null,this.towerController.setDragingState(!1)}this.opMode=o}},onTouchCancel:function(t){this.towerController.onTouchCancel(),this.combineController.isBuildingTab()&&(this.opMode==r?(this.destoryDragItem(),this.destroyDragBuilding(),this.slotController&&this.slotController.show(),this.slotController=null):this.opMode==a?(this.destoryDragItem(),this.destroyDragBuilding(),this.dragBuildingController&&this.dragBuildingController.show(),this.dragBuildingController=null,this.towerController.setDragingState(!1)):(this.destoryDragItem(),this.destroyDragBuilding(),this.dragBuildingController&&(this.dragBuildingController.show(),this.dragBuildingController=null),this.slotController&&(this.slotController.show(),this.slotController=null)))}}),cc._RF.pop()},{objectFactory:"objectFactory",uiController:"uiController"}],scienceSetting:[function(t,e,n){"use strict";cc._RF.push(e,"ab0343H34JMZp2Btz7RsVlF","scienceSetting");var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(){o(this,t),this._infoMap={},this._defaultInfo={}}return i(t,[{key:"verifyInfo",value:function(t){0===t.id&&(cc.assert(null===item.value),cc.assert(null!=item.value)),cc.assert(0!==t.sciLvlArray.length)}},{key:"parse",value:function(t){var e=this;Object.values(t).forEach(function(t){var n={};t.id&&(n.id=Number(t.id),n.name=t.name,n.sprite=t.sprite,n.sciLvlArray=[],t.sciLvl.forEach(function(t){var e={};e.level=t.level,e.value=t.value,e.desc=t.desc,e.upDesc=t.upDesc,e.preSci=t.preSci,e.preSciLvl=t.preSciLvl,e.costDiamond=t.costDiamond,n.sciLvlArray.push(e)}),e._infoMap[n.id]=n)})}},{key:"getScienceLevelInfo",value:function(t,e){var n=this._infoMap[t];if(n){for(var i=0;i<n.sciLvlArray.length;i++){var o=n.sciLvlArray[i];if(o.level===e)return o}return null}console.error("getScienceLevelInfo: id: "+t+" not exist")}},{key:"getScienceInfo",value:function(t){return this._infoMap[t]}},{key:"getInfoMap",value:function(){return this._infoMap}}]),t}();e.exports=r,cc._RF.pop()},{}],settingMgr:[function(t,e,n){"use strict";cc._RF.push(e,"d8fe5fnPRBIkbenH0LnEOLz","settingMgr");var i=t("enemySetting"),o=t("enemyGroupSetting"),r=t("buildingSetting"),a=t("buildingLevelSetting"),s=t("stagesSetting"),c=t("bulletSetting"),l=t("mapSetting"),u=t("constantSetting"),h=t("scienceSetting"),f=t("textSetting"),d=t("buffSetting"),g={init:function(){this.settingSet={enemy:new i,enemyGroup:new o,building:new r,buildingLevel:new a,stages:new s,bullet:new c,map:new l,constant:new u,science:new h,text:new f,buff:new d},this.loadSetting()},loadSetting:function(){var t=this;cc.loader.loadResDir("json",function(e,n){if(null==e)for(var i=0;i<n.length;i++){var o=null;o=n[i].name.indexOf("map")>=0?t.settingSet.map:t.settingSet[n[i].name],cc.assert(o),o?(o.parse(n[i].json),cc.loader.release(n[i])):cc.loader.release(n[i])}else cc.assert(!1,"loadResDir json error :"+e)})},getSetting:function(t){return this.settingSet[t]}};e.exports=g,cc._RF.pop()},{buffSetting:"buffSetting",buildingLevelSetting:"buildingLevelSetting",buildingSetting:"buildingSetting",bulletSetting:"bulletSetting",constantSetting:"constantSetting",enemyGroupSetting:"enemyGroupSetting",enemySetting:"enemySetting",mapSetting:"mapSetting",scienceSetting:"scienceSetting",stagesSetting:"stagesSetting",textSetting:"textSetting"}],slotController:[function(t,e,n){"use strict";cc._RF.push(e,"7b9c5rhxapC5KFAc41mAksQ","slotController");var i=t("settingMgr"),o=t("helper"),r=t("objectFactory"),a=t("constant").Event;cc.Class({extends:cc.Component,properties:{sprite:cc.Sprite,levelBack:cc.Sprite,levelLabel:cc.Label},onLoad:function(){this.node.on(a.CombineFinish,this.combineFinish,this)},combineFinish:function(){this.sprite.enabled=!0},init:function(t,e,n){this.index=t,this.uiController=e,this.userController=n,this.buildingID=0,this.level=0,this.buildingPrefabName=null,this.sprite.node.active=!1;var r=i.getSetting("constant");this.moneyGenInterval=r.getValue("BUILDING_OUTPUT_INTERVAL");var a=o.random(1,1e3*this.moneyGenInterval);this.randomInterval=a/1e3,this.schedule(this.autoMoney,this.randomInterval)},autoMoney:function(){if(this.randomInterval!==this.moneyGenInterval&&(this.randomInterval=this.moneyGenInterval,this.unschedule(this.autoMoney),this.schedule(this.autoMoney,this.moneyGenInterval)),0!==this.buildingID){var t=i.getSetting("buildingLevel").getBuildingLevelInfo(this.level),e=this.node.parent.convertToWorldSpaceAR(this.node.position);e.y+=this.node.height/2;var n=this.moneyGenInterval*t.addGold;this.uiController.generateAutoMoneyTip(e,n),this.userController.addCoin(n,!1)}},updateInfo:function(t){if(0!==t){var e=i.getSetting("building").getBuildingInfo(t);e?(this.buildingID=t,this.level=e.level,this.buildingPrefabName=e.prefab,this.sprite.node.active=!0,this.buildingAttackRange=e.attRange,this.updateUI()):console.error("slotController updateInfo error buildingInfo not exist id= ",t)}},setIndex:function(t){this.index=t},getIndex:function(){return this.index},getSlotInfo:function(){var t={};return t.index=this.index,t.buildingID=this.buildingID,t.level=this.level,t.buildingPrefabName=this.buildingPrefabName,t.buildingAttackRange=this.buildingAttackRange,t},getSlotBuildingID:function(){return this.buildingID},getSlotBuildingLevel:function(){return this.level},updateUI:function(){0==this.buildingID?(this.sprite.spriteFrame=null,this.levelBack.node.active=!1):(this.setSpriteFrame(this.sprite,this.buildingPrefabName),this.levelBack.node.active=!0,this.levelLabel.string=this.level,this.sprite.node.active=!0)},show:function(){this.sprite.node.opacity=255},hide:function(){this.sprite.node.opacity=130},getSpriteFrame:function(){return this.sprite.spriteFrame},setSpriteFrame:function(t,e){var n="sprite/building/";n+=e.replace("building_","");var i=cc.loader.getRes(n,cc.SpriteFrame);cc.assert(i);var o=i.getOriginalSize(),r=100/Math.max(o.width,o.height);t.spriteFrame=i,t.node.width=r*o.width,t.node.height=r*o.height},reset:function(){this.buildingID=0,this.level=0,this.prefab=0,this.sprite.spriteFrame=null,this.sprite.node.opacity=255,this.updateUI()},isEmpty:function(){return!this.buildingID||0===this.buildingID},replace:function(t){var e=t.getSlotInfo();return 0===this.buildingID&&(this.updateInfo(e.buildingID),!0)},combine:function(t){var e=t.getSlotInfo();if(this.buildingID===e.buildingID){var n=i.getSetting("building").getBuildingInfo(this.buildingID);if(0===n.next)return!1;var o=cc.loader.getRes("effectPrefab/effect_merge",cc.Prefab);cc.assert(o);var a=r.getObject(o),s=cc.Canvas.instance.node;return a.parent=s,a.position=s.convertToNodeSpaceAR(this.node.parent.convertToWorldSpaceAR(this.node.position)),a.getComponent("combineEffectController").init(this.getSpriteFrame(),t.getSpriteFrame(),this.node),this.sprite.enabled=!1,this.updateInfo(n.next),!0}return!1}}),cc._RF.pop()},{constant:"constant",helper:"helper",objectFactory:"objectFactory",settingMgr:"settingMgr"}],spriteSet:[function(t,e,n){"use strict";cc._RF.push(e,"a1bc4V7APtGALOYYutjcF1e","spriteSet"),cc.Class({extends:cc.Component,properties:{sprWidth:cc.Integer},onLoad:function(){this.spr=this.node.getComponent(cc.Sprite)},update:function(t){null!==this.spr.spriteFrame&&this.setSprScale()},setSprScale:function(){var t=this.spr.spriteFrame.getOriginalSize(),e=this.sprWidth/Math.max(t.width,t.height);this.node.width=e*t.width,this.node.height=e*t.height}}),cc._RF.pop()},{}],stagesSetting:[function(t,e,n){"use strict";cc._RF.push(e,"1f623ht3DNC57gDz4XZ8vZO","stagesSetting");var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(){o(this,t),this.stageArray=[],this.stageMap={}}return i(t,[{key:"parse",value:function(t){var e=this;this.stageMap={},cc.assert(Array.isArray(t)),t.forEach(function(t){var n={};t.id&&(e.stageArray.push(n),n.ID=t.id,n.stageMap=t.stage1,n.enemyGroup=t.enemyGroup,n.enemyHpFix=t.enemyHpFix,n.gold=t.gold,n.enemyGroup=t.enemyGroup,n.diamond=t.diamond,n.diamondBox=t.diamondBox,n.bgAltas=t.bgAtlas,n.bgSprite=t.bgSprite,e.stageMap[t.id]=t)})}},{key:"getStageEnemyGroup",value:function(t){var e=this.stageMap[t];return e||(cc.log("this.stageMap[stage] stage="+t),cc.assert(!1)),e.enemyGroup}},{key:"getStageInfo",value:function(t){return this.stageMap[t]}}]),t}();e.exports=r,cc._RF.pop()},{}],"state-machine":[function(t,e,n){"use strict";cc._RF.push(e,"c7c80vmbIlHsK12gLlklHy/","state-machine");var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};(function(t,o){"object"===(void 0===n?"undefined":i(n))&&"object"===(void 0===e?"undefined":i(e))?e.exports=o():"function"==typeof define&&define.amd?define("StateMachine",[],o):"object"===(void 0===n?"undefined":i(n))?n.StateMachine=o():t.StateMachine=o()})(void 0,function(){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.i=function(t){return t},n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:i})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=5)}([function(t,e,n){t.exports=function(t,e){var n,i,o;for(n=1;n<arguments.length;n++)for(o in i=arguments[n])i.hasOwnProperty(o)&&(t[o]=i[o]);return t}},function(t,e,n){var i=n(0);t.exports={build:function(t,e){var n,o,r,a=e.plugins;for(n=0,o=a.length;n<o;n++)(r=a[n]).methods&&i(t,r.methods),r.properties&&Object.defineProperties(t,r.properties)},hook:function(t,e,n){var i,o,r,a,s=t.config.plugins,c=[t.context];for(n&&(c=c.concat(n)),i=0,o=s.length;i<o;i++)a=s[i],(r=s[i][e])&&r.apply(a,c)}}},function(t,e,n){function i(t){if(0===t.length)return t;var e,n,i=t.split(/[_-]/);if(1===i.length&&i[0][0].toLowerCase()===i[0][0])return t;for(n=i[0].toLowerCase(),e=1;e<i.length;e++)n=n+i[e].charAt(0).toUpperCase()+i[e].substring(1).toLowerCase();return n}i.prepended=function(t,e){return t+(e=i(e))[0].toUpperCase()+e.substring(1)},t.exports=i},function(t,e,n){var o=n(0),r=n(2);function a(t,e){t=t||{},this.options=t,this.defaults=e.defaults,this.states=[],this.transitions=[],this.map={},this.lifecycle=this.configureLifecycle(),this.init=this.configureInitTransition(t.init),this.data=this.configureData(t.data),this.methods=this.configureMethods(t.methods),this.map[this.defaults.wildcard]={},this.configureTransitions(t.transitions||[]),this.plugins=this.configurePlugins(t.plugins,e.plugin)}o(a.prototype,{addState:function(t){this.map[t]||(this.states.push(t),this.addStateLifecycleNames(t),this.map[t]={})},addStateLifecycleNames:function(t){this.lifecycle.onEnter[t]=r.prepended("onEnter",t),this.lifecycle.onLeave[t]=r.prepended("onLeave",t),this.lifecycle.on[t]=r.prepended("on",t)},addTransition:function(t){this.transitions.indexOf(t)<0&&(this.transitions.push(t),this.addTransitionLifecycleNames(t))},addTransitionLifecycleNames:function(t){this.lifecycle.onBefore[t]=r.prepended("onBefore",t),this.lifecycle.onAfter[t]=r.prepended("onAfter",t),this.lifecycle.on[t]=r.prepended("on",t)},mapTransition:function(t){var e=t.name,n=t.from,i=t.to;return this.addState(n),"function"!=typeof i&&this.addState(i),this.addTransition(e),this.map[n][e]=t,t},configureLifecycle:function(){return{onBefore:{transition:"onBeforeTransition"},onAfter:{transition:"onAfterTransition"},onEnter:{state:"onEnterState"},onLeave:{state:"onLeaveState"},on:{transition:"onTransition"}}},configureInitTransition:function(t){return"string"==typeof t?this.mapTransition(o({},this.defaults.init,{to:t,active:!0})):"object"===(void 0===t?"undefined":i(t))?this.mapTransition(o({},this.defaults.init,t,{active:!0})):(this.addState(this.defaults.init.from),this.defaults.init)},configureData:function(t){return"function"==typeof t?t:"object"===(void 0===t?"undefined":i(t))?function(){return t}:function(){return{}}},configureMethods:function(t){return t||{}},configurePlugins:function(t,e){var n,i,o;for(n=0,i=(t=t||[]).length;n<i;n++)"function"==typeof(o=t[n])&&(t[n]=o=o()),o.configure&&o.configure(this);return t},configureTransitions:function(t){var e,n,i,o,r,a=this.defaults.wildcard;for(n=0;n<t.length;n++)for(i=t[n],o=Array.isArray(i.from)?i.from:[i.from||a],r=i.to||a,e=0;e<o.length;e++)this.mapTransition({name:i.name,from:o[e],to:r})},transitionFor:function(t,e){var n=this.defaults.wildcard;return this.map[t][e]||this.map[n][e]},transitionsFor:function(t){var e=this.defaults.wildcard;return Object.keys(this.map[t]).concat(Object.keys(this.map[e]))},allStates:function(){return this.states},allTransitions:function(){return this.transitions}}),t.exports=a},function(t,e,n){var i=n(0),o=n(6),r=n(1),a=[null,[]];function s(t,e){this.context=t,this.config=e,this.state=e.init.from,this.observers=[t]}i(s.prototype,{init:function(t){if(i(this.context,this.config.data.apply(this.context,t)),r.hook(this,"init"),this.config.init.active)return this.fire(this.config.init.name,[])},is:function(t){return Array.isArray(t)?t.indexOf(this.state)>=0:this.state===t},isPending:function(){return this.pending},can:function(t){return!this.isPending()&&!!this.seek(t)},cannot:function(t){return!this.can(t)},allStates:function(){return this.config.allStates()},allTransitions:function(){return this.config.allTransitions()},transitions:function(){return this.config.transitionsFor(this.state)},seek:function(t,e){var n=this.config.defaults.wildcard,i=this.config.transitionFor(this.state,t),o=i&&i.to;return"function"==typeof o?o.apply(this.context,e):o===n?this.state:o},fire:function(t,e){return this.transit(t,this.state,this.seek(t,e),e)},transit:function(t,e,n,i){var o=this.config.lifecycle,r=this.config.options.observeUnchangedState||e!==n;return n?this.isPending()?this.context.onPendingTransition(t,e,n):(this.config.addState(n),this.beginTransit(),i.unshift({transition:t,from:e,to:n,fsm:this.context}),this.observeEvents([this.observersForEvent(o.onBefore.transition),this.observersForEvent(o.onBefore[t]),r?this.observersForEvent(o.onLeave.state):a,r?this.observersForEvent(o.onLeave[e]):a,this.observersForEvent(o.on.transition),r?["doTransit",[this]]:a,r?this.observersForEvent(o.onEnter.state):a,r?this.observersForEvent(o.onEnter[n]):a,r?this.observersForEvent(o.on[n]):a,this.observersForEvent(o.onAfter.transition),this.observersForEvent(o.onAfter[t]),this.observersForEvent(o.on[t])],i)):this.context.onInvalidTransition(t,e,n)},beginTransit:function(){this.pending=!0},endTransit:function(t){return this.pending=!1,t},failTransit:function(t){throw this.pending=!1,t},doTransit:function(t){this.state=t.to},observe:function(t){if(2===t.length){var e={};e[t[0]]=t[1],this.observers.push(e)}else this.observers.push(t[0])},observersForEvent:function(t){for(var e,n=0,i=this.observers.length,o=[];n<i;n++)(e=this.observers[n])[t]&&o.push(e);return[t,o,!0]},observeEvents:function(t,e,n,i){if(0===t.length)return this.endTransit(void 0===i||i);var o=t[0][0],a=t[0][1],s=t[0][2];if(e[0].event=o,o&&s&&o!==n&&r.hook(this,"lifecycle",e),0===a.length)return t.shift(),this.observeEvents(t,e,o,i);var c=a.shift(),l=c[o].apply(c,e);return l&&"function"==typeof l.then?l.then(this.observeEvents.bind(this,t,e,o)).catch(this.failTransit.bind(this)):!1===l?this.endTransit(!1):this.observeEvents(t,e,o,l)},onInvalidTransition:function(t,e,n){throw new o("transition is invalid in current state",t,e,n,this.state)},onPendingTransition:function(t,e,n){throw new o("transition is invalid while previous transition is still in progress",t,e,n,this.state)}}),t.exports=s},function(t,e,n){var o=n(0),r=n(2),a=n(1),s=n(3),c=n(4),l={is:function(t){return this._fsm.is(t)},can:function(t){return this._fsm.can(t)},cannot:function(t){return this._fsm.cannot(t)},observe:function(){return this._fsm.observe(arguments)},transitions:function(){return this._fsm.transitions()},allTransitions:function(){return this._fsm.allTransitions()},allStates:function(){return this._fsm.allStates()},onInvalidTransition:function(t,e,n){return this._fsm.onInvalidTransition(t,e,n)},onPendingTransition:function(t,e,n){return this._fsm.onPendingTransition(t,e,n)}},u={state:{configurable:!1,enumerable:!0,get:function(){return this._fsm.state},set:function(t){throw Error("use transitions to change state")}}};function h(t){return f(this||{},t)}function f(t,e){return d(t,new s(e,h)),t._fsm(),t}function d(t,e){if("object"!==(void 0===t?"undefined":i(t))||Array.isArray(t))throw Error("StateMachine can only be applied to objects");a.build(t,e),Object.defineProperties(t,u),o(t,l),o(t,e.methods),e.allTransitions().forEach(function(e){t[r(e)]=function(){return this._fsm.fire(e,[].slice.call(arguments))}}),t._fsm=function(){this._fsm=new c(this,e),this._fsm.init(arguments)}}h.version="3.0.1",h.factory=function(){var t,e;"function"==typeof arguments[0]?(t=arguments[0],e=arguments[1]||{}):(t=function(){this._fsm.apply(this,arguments)},e=arguments[0]||{});var n=new s(e,h);return d(t.prototype,n),t.prototype._fsm.config=n,t},h.apply=f,h.defaults={wildcard:"*",init:{name:"init",from:"none"}},t.exports=h},function(t,e,n){t.exports=function(t,e,n,i,o){this.message=t,this.transition=e,this.from=n,this.to=i,this.current=o}}])}),cc._RF.pop()},{}],techGuideTask:[function(t,e,n){"use strict";cc._RF.push(e,"1cb10rKAhlAToxD7MiXXFsK","techGuideTask");var i=t("guideCommand");e.exports={name:"\u79d1\u6280\u5f00\u542f\u5f15\u5bfc",debug:!0,steps:[{desc:"\u6587\u672c\u63d0\u793a",command:{cmd:i.TEXTTOUCH,args:"\u70b9\u51fb\u7814\u7a76\u9875\u7b7e\uff01"},delayTime:1},{desc:"\u70b9\u51fb\u7814\u7a76\u9875\u7b7e",command:{cmd:i.FINGER,args:["Game > Combine > TabBar > TechTab > Background"]}},{desc:"\u6587\u672c\u63d0\u793a",command:{cmd:i.TEXT,args:"\u70b9\u51fb\u5347\u7ea7\u7814\u7a76"}},{desc:"\u70b9\u51fb\u5347\u7ea7\u7814\u7a76",command:{cmd:i.FINGER,args:["Game > Combine > TabBar > TechTab"]}}]},cc._RF.pop()},{guideCommand:"guideCommand"}],techItemController:[function(t,e,n){"use strict";cc._RF.push(e,"a21d89laKVBW4C1mxprQITS","techItemController");var i=t("settingMgr"),o=t("userController");cc.Class({extends:cc.Component,properties:{techName:cc.RichText,level:cc.RichText,cost:cc.Label,desc:cc.Label,nextDesc:cc.Label,techSprite:cc.Sprite,userController:o,upgradeButton:cc.Button,info:cc.Node,text:cc.Label},init:function(t,e,n,i){this.techID=t,this.techLevel=e,this.userController=n,this.uiController=i,this.updateInfo()},updateInfoCondition:function(){this.updateInfo(this.techID,this.techLevel)},updateInfo:function(){var t=i.getSetting("science"),e=t.getScienceInfo(this.techID);if(e){var n=t.getScienceLevelInfo(this.techID,this.techLevel);if(n){this.updateUI(e.name,n.level,n.costDiamond,n.desc,n.upDesc,e.sprite);var o=t.getScienceLevelInfo(this.techID,this.techLevel+1);if(o){if(o.preSci){var r=t.getScienceInfo(o.preSci);if(!r)return;if(this.userController.getTechInfo(o.preSci).level<o.level){this.upgradeButton.interactable=!1,this.info.active=!1,this.text.node.active=!0;var a=i.getSetting("text").getText("10103");return a=(a=a.replace("$[arg1]",r.name)).replace("$[arg2]",o.level),void(this.text.string=a)}this.upgradeButton.interactable=!0,this.info.active=!0,this.text.node.active=!1,this.updateUI(e.name,n.level,n.costDiamond,n.desc,n.upDesc,e.sprite)}}else this.hightestLevel()}}},updateUI:function(t,e,n,i,o,r){this.techName.string=t,this.level.string=e.toString(),this.cost.string=n,this.desc.string=i,this.nextDesc.string=o;var a=cc.loader.getRes("sprite/technology/"+r,cc.SpriteFrame);this.techSprite.spriteFrame=a},upgrade:function(){var t=i.getSetting("science"),e=t.getScienceLevelInfo(this.techID,this.techLevel+1);if(e.preSci&&this.userController.getTechInfo(e.preSci).level<e.level)return;var n=t.getScienceLevelInfo(this.techID,this.techLevel),o=t.getScienceInfo(this.techID);if(this.userController.isDiamondEnough(n.costDiamond)){this.userController.reduceDiamond(n.costDiamond),this.userController.changeTechInfo(this.techID,this.techLevel+1),this.techLevel+=1,this.updateInfo();var r=[];r.push(o.name),r.push(this.techLevel),this.uiController.generateTip("10105",r)}else this.uiController.generateTip("10102")},hightestLevel:function(){this.upgradeButton.interactable=!1,this.info.active=!1,this.text.node.active=!0;var t=i.getSetting("text").getText("10104");this.text.string=t}}),cc._RF.pop()},{settingMgr:"settingMgr",userController:"userController"}],textSetting:[function(t,e,n){"use strict";cc._RF.push(e,"75e6bViQhxG6ZQjaSOk7xZV","textSetting");var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(){o(this,t),this._infoMap={}}return i(t,[{key:"parse",value:function(t){var e=this;Object.values(t).forEach(function(t){var n={};t.id&&(n.id=t.id,n.text=t.text,e._infoMap[n.id]=n)})}},{key:"getText",value:function(t){return this._infoMap[t].text}}]),t}();e.exports=r,cc._RF.pop()},{}],tipController:[function(t,e,n){"use strict";cc._RF.push(e,"0b77cM/ki9BNoQW8QbbVAKi","tipController");var i=t("objectFactory");cc.Class({extends:cc.Component,properties:{text:cc.Label,inTime:cc.Interger=1,inMove:cc.Interger=100,stayTime:cc.Interger=2,outTime:cc.Interger=1,outMove:cc.Interger=200},setText:function(t){this.text.string=t,this.runToastAction()},runToastAction:function(){this.node.stopAllActions();var t=parseInt(this.inTime)/1e3,e=parseInt(this.inMove),n=parseInt(this.stayTime)/1e3,o=parseInt(this.outTime)/1e3,r=parseInt(this.outMove),a=cc.spawn(cc.fadeIn(t),cc.moveBy(t,cc.v2(0,e)).easing(cc.easeCubicActionOut())),s=cc.spawn(cc.fadeOut(o),cc.moveBy(o,cc.v2(0,r)).easing(cc.easeCubicActionIn()));this.node.runAction(cc.sequence(a,cc.delayTime(n),s,cc.callFunc(function(){i.putObject(this.node)}.bind(this))))}}),cc._RF.pop()},{objectFactory:"objectFactory"}],towerController:[function(t,e,n){"use strict";cc._RF.push(e,"c12195I7wtBU4pu6OTPYaHh","towerController");var i=t("Astar"),o=t("settingMgr"),r=t("helper"),a=t("uiController"),s=t("combineController"),c=t("userController"),l=t("constant"),u=l.Event,h=t("objectFactory"),f=l.Direction;cc.Class({extends:cc.Component,properties:{uiController:a,userController:c,combineController:s,skySprite:cc.Sprite,groundSprite:cc.Sprite,speedDetect:cc.Node,roadLayer:cc.Node,buildingLayer:cc.Node,enemyLayer:cc.Node,bulletLayer:cc.Node,mapNode:cc.Node,roadTilePrefab:cc.Prefab},tileMapGridCoordToMapNodePos:function(t){var e=cc.v2(t.x+.5,t.y+.5),n=e.x*this.tileSize.width-this.tileMapSize.width/2,i=e.y*this.tileSize.height-this.tileMapSize.height/2;return cc.v2(n,i)},mapNodePosToTileMapGridCoord:function(t){var e=t.x+this.tileMapSize.width/2,n=t.y+this.tileMapSize.height/2,i=Math.floor(e/this.tileSize.width),o=Math.floor(n/this.tileSize.height);return cc.v2(i,o)},mapNodePosToWorldSpaceAR:function(t){return this.mapNode.convertToWorldSpaceAR(t)},tileMapGridCoordToGridIndex:function(t){return Math.floor(t.y*this.mapSizeByGrid.width+t.x)},gridIndexToTileMapGridCoord:function(t){var e=this.mapSizeByGrid.width,n=Math.floor(t%e),i=Math.floor(t/e);return cc.v2(n,i)},touchPosToTileGridIndex:function(t){var e=this.mapNode.convertToNodeSpaceAR(t),n=this.mapNodePosToTileMapGridCoord(e);return this.tileMapGridCoordToGridIndex(n)},onLoad:function(){this.gridMap={},h.buildObjectPool(this.roadTilePrefab,200)},initTechAttr:function(){var t=this.userController.getTechInfo(7),e=this.userController.getTechInfo(6),n=o.getSetting("science"),i=n.getScienceLevelInfo(t.id,t.level);this.maxBuildingNum=this.baseBuildingNum+i.value,this.uiController.updateTowerBuildingNum(Object.keys(this.gridMap).length,this.maxBuildingNum);var r=n.getScienceLevelInfo(e.id,e.level);Object.values(this.gridMap).forEach(function(t){t.buildingController.setAttackHurtRate(1+r.value)})},init:function(t,e){var n=o.getSetting("constant"),r=o.getSetting("stages"),a=o.getSetting("map"),s=o.getSetting("enemyGroup");this.stage=t,this.stageSettingInfo=r.getStageInfo(this.stage),this.baseBuildingNum=n.getValue("BUILDING_NUM_MAX"),this.maxBuildingNum=this.baseBuildingNum,this.uiController.updateStage(this.stage),this.mapName=this.stageSettingInfo.stageMap;var c=cc.loader.getRes("map/"+this.mapName,cc.tileMapAsset);cc.assert(c),this.mapNode.getComponent(cc.TiledMap).tmxAsset=c,this.enemyOnRoad=[],this.enemyReach=[],this.bulletMap=[],this.uiController.updateTowerBuildingNum(Object.keys(this.gridMap).length,this.maxBuildingNum),this.defending=!1,this.isDragingState=!1,this._timeCounter=0,this._lastGenMonsterTime=0,this.astar=new i,this.tileMapSize=cc.size(this.mapNode.width,this.mapNode.height),this.tileSize=a.getTileSize(this.mapName),this.mapSizeByGrid=a.getMapSize(this.mapName),this.enemySpwanArray=s.getEnemyGroupArray(this.stageSettingInfo.enemyGroup),this.exit=a.getExit(this.mapName),this.roadMap=a.getRoadMap(this.mapName),this.obstacleMap=a.getObstacleMap(this.mapName),this.bornTileSprite=cc.loader.getRes("sprite/preload/icon_born",cc.SpriteFrame),this.exitTileNormalFrame=cc.loader.getRes("sprite/preload/icon_dspr",cc.SpriteFrame),this.exitTileDestroyFrame=cc.loader.getRes("sprite/preload/icon_dspr2",cc.SpriteFrame),cc.assert(this.bornTileSprite&&this.exitTileNormalFrame&&this.exitTileDestroyFrame);var l=cc.loader.getRes(this.stageSettingInfo.bgAtlas,cc.SpriteAtlas).getSpriteFrame(this.stageSettingInfo.bgSprite);if(this.groundSprite.spriteFrame=l,this.buildRoad(this.roadMap),this.buildObstacle(this.obstacleMap),this.initTechAttr(),this.initEvent(),e){for(var u=o.getSetting("building"),h=0;h<e.length;h++){var f=e[h],d=u.getBuildingInfo(f.buildingID),g=cc.loader.getRes("buildingPrefab/"+d.prefab,cc.Prefab),p=cc.instantiate(g);p.position=f.position,p.parent=this.buildingLayer;var v=p.getComponent("buildingController");v.hideBase();var m=this.tileMapGridCoordToGridIndex(this.mapNodePosToTileMapGridCoord(p.position));this.gridMap[m]={},this.gridMap[m].buildingController=v,this.gridMap[m].isValid=!0,v.init(f.buildingID,this);var b=p.getComponent(cc.BoxCollider),y=p.position;y=y.addSelf(b.offset);var C=cc.v2(y.x-b.size.width/2,y.y+b.size.height/2),S=cc.v2(y.x-b.size.width/2,y.y-b.size.height/2),T=cc.v2(y.x+b.size.width/2,y.y+b.size.height/2),I=this.mapNodePosToTileMapGridCoord(C),B=this.mapNodePosToTileMapGridCoord(T),_=this.mapNodePosToTileMapGridCoord(S),x=I.x,w=B.x,R=I.y,N=_.y;t:for(var M=R;M<=N;M++)for(var F=x;F<=w;F++){var P=Math.floor(M*this.mapSizeByGrid.width+F);if(this.isRoad(P)||this.isObstacle(P)){v.showRedBase(),this.gridMap[m].isValid=!1,v.showWarning();break t}}}this.uiController.updateTowerBuildingNum(Object.keys(this.gridMap).length,this.maxBuildingNum)}},initEvent:function(){this.node.on(u.TechInfoChange,this.techInfoChange,this)},techInfoChange:function(t,e){var n=o.getSetting("science");if(5===t){var i=n.getScienceLevelInfo(t,e);Object.values(this.gridMap).forEach(function(t){t.buildingController.setAttackHurtRate(1+i.value)})}else if(7===t){var r=n.getScienceLevelInfo(t,e);this.maxBuildingNum=this.baseBuildingNum+r.value,this.uiController.updateTowerBuildingNum(Object.keys(this.gridMap).length,this.maxBuildingNum)}},buildRoad:function(t){for(var e=this.mapSizeByGrid.width,n=this.mapSizeByGrid.height,i=o.getSetting("map"),r=0;r<n;r++)for(var a=0;a<e;a++)if(0!==t[r][a]){var s=h.getObject(this.roadTilePrefab),c=s.getComponent(cc.Sprite),l=a+r*e;i.isEntranceByIndex(this.mapName,l)?c.spriteFrame=this.bornTileSprite:a===this.exit.x&&r===this.exit.y?(c.spriteFrame=this.exitTileNormalFrame,this.exitTileSpriteComp=c):c.spriteFrame=null,s.parent=this.roadLayer;var u=this.tileMapGridCoordToMapNodePos(cc.v2(a,r));s.position=u}},buildObstacle:function(t){for(var e=this.mapSizeByGrid.width,n=this.mapSizeByGrid.height,i=0;i<n;i++)for(var o=0;o<e;o++)if(0!==t[i][o]){var r=h.getObject(this.roadTilePrefab);r.getComponent(cc.Sprite).spriteFrame=null,r.parent=this.roadLayer;var a=this.tileMapGridCoordToMapNodePos(cc.v2(o,i));r.position=a}},buildMap:function(t){for(var e=this.mapSizeByGrid.width,n=this.mapSizeByGrid.height,i=0;i<n;i++)for(var o=0;o<e;o++){var r=cc.instantiate(this.roadTilePrefab);r.parent=this.buildingLayer;var a=this.tileMapGridCoordToMapNodePos(cc.v2(o,i));r.position=a}},isDefending:function(){return this.defending},startDefend:function(){if(0!==Object.keys(this.gridMap).length){var t=!0,e=!0,n=!1,i=void 0;try{for(var o,r=Object.values(this.gridMap)[Symbol.iterator]();!(e=(o=r.next()).done);e=!0){var a=o.value;a.isValid||(a.buildingController.playWarningAnimation(),t=!1)}}catch(t){n=!0,i=t}finally{try{!e&&r.return&&r.return()}finally{if(n)throw i}}if(t){this.defending=!0,this.schedule(this.enemySpawn,.1),this.enemySpawn(),this.uiController.showStartButton(!1);var s=[];s.push(this.stage),this.uiController.generateTip("10303",s),Object.values(this.gridMap).forEach(function(t){t.buildingController.startAttack()})}else this.uiController.generateTip("10305")}else this.uiController.generateTip("10304")},stopDefend:function(){this.defending=!1,this.unschedule(this.enemySpawn),this.enemyOnRoad.forEach(function(t){t.stopMove()}),Object.values(this.gridMap).forEach(function(t){t.buildingController.stopAttack()})},enemySpawn:function(){var t=this;this._timeCounter=this._timeCounter+100,this.enemySpwanArray.forEach(function(e){if(e.time<t._timeCounter&&e.time>t._lastGenMonsterTime){var n=o.getSetting("map").getEntrance(t.mapName,e.position);if(!n)return;for(var i=t.astar.getPath(t.roadMap,n,t.exit),a=[],s=f.Right,c=0;c<i.length;c++){var l={};l.direction=f.Right,l.position=t.tileMapGridCoordToMapNodePos(i[c].getPosition()),a.push(l),i[c+1]?i[c+1].position.x>i[c].position.x?l.direction=f.Right:i[c+1].position.x<i[c].position.x?l.direction=f.Left:l.direction=s:l.direction=s;var u=r.random(-15,16),d=r.random(-15,16);l.position.x+=u,l.position.y+=d,s=l.direction}var g=o.getSetting("enemy").getEnemyInfo(e.enemy),p=cc.loader.getRes("rolePrefab/"+g.prefab,cc.Prefab);cc.assert(p);var v=h.getObject(p);v.parent=t.enemyLayer,v.position=t.tileMapGridCoordToMapNodePos(n);var m=r.genID(),b=v.getComponent("enemyController");b.init(m,e.enemy,a,t.stageSettingInfo.enemyHpFix,t),b.startMove(),t.enemyOnRoad.push(b),t._lastGenMonsterTime=t._timeCounter}})},isTowerArea:function(t){var e=this.mapNode.convertToNodeSpaceAR(t);return this.mapNode.getBoundingBox().contains(e)},isRoad:function(t){var e=this.gridIndexToTileMapGridCoord(t);return!(!this.roadMap[e.y]||!this.roadMap[e.y][e.x]||0===this.roadMap[e.y][e.x])},isObstacle:function(t){var e=this.gridIndexToTileMapGridCoord(t);return!(!this.obstacleMap[e.y]||!this.obstacleMap[e.y][e.x]||0===this.obstacleMap[e.y][e.x])},isTouchBuildingExceptIndex:function(t,e){if(this.isDefending())return!0;var n=this.buildingLayer.convertToNodeSpaceAR(t),i=!0,o=!1,r=void 0;try{for(var a,s=Object.keys(this.gridMap)[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var c=a.value;if(e!==c)if(this.gridMap[c].buildingController.node.getBoundingBox().contains(n))return!0}}catch(t){o=!0,r=t}finally{try{!i&&s.return&&s.return()}finally{if(o)throw r}}return!1},isTouchBuilding:function(t){if(this.isDefending())return null;var e=this.buildingLayer.convertToNodeSpaceAR(t),n=!0,i=!1,o=void 0;try{for(var r,a=Object.keys(this.gridMap)[Symbol.iterator]();!(n=(r=a.next()).done);n=!0){var s=r.value,c=this.gridMap[s];if(c.buildingController.node.getBoundingBox().contains(e)){var l={};return l.buildingController=c.buildingController,l.index=s,l}}}catch(t){i=!0,o=t}finally{try{!n&&a.return&&a.return()}finally{if(i)throw o}}return null},removeBuilding:function(t){var e=this.gridMap[t].buildingController;e&&(e.node.destroy(),delete this.gridMap[t],this.uiController.updateTowerBuildingNum(Object.keys(this.gridMap).length,this.maxBuildingNum),this.saveBuildingRecord())},setDragingState:function(t){this.isDragingState=t},placeBuilding:function(t,e,n){if(!this.isDefending()){var i=e.getComponent("buildingController");if(i.isCanPlace()){i.hideAttackRange();var o=this.touchPosToTileGridIndex(n);if(this.gridMap[o])return!1;var r=Object.keys(this.gridMap).length;if(this.isDragingState&&r--,this.maxBuildingNum==r)return this.uiController.generateTip("10302"),!1;if(this.isRoad(o))return this.uiController.generateTip("10301"),!1;var a=cc.instantiate(e);a.position=e.position,a.parent=this.buildingLayer;var s=a.getComponent("buildingController");return s.hideBase(),s.init(t,this),this.gridMap[o]={},this.gridMap[o].buildingController=s,this.gridMap[o].isValid=!0,s.hideWarning(),this.uiController.updateTowerBuildingNum(r+1,this.maxBuildingNum),this.saveBuildingRecord(),!0}this.uiController.generateTip("10301")}},exitTileFrameReset:function(){this.exitTileSpriteComp.spriteFrame=this.exitTileNormalFrame},onEnemyReach:function(t){if(this.enemyReach.push(t),this.exitTileSpriteComp.spriteFrame=this.exitTileDestroyFrame,this.unschedule(this.exitTileFrameReset),this.schedule(this.exitTileFrameReset,1),this.enemyOnRoad=this.enemyOnRoad.filter(function(e){return e.id!==t.id}),!t.isFeedFull())return this.stopDefend(),void this.uiController.lose(this.stage);0===this.enemyOnRoad.length&&this.uiController.win(this.stage)},onBulletHit:function(t){delete this.bulletMap[t.id]},saveBuildingRecord:function(){var t=this,e=[];Object.values(this.gridMap).forEach(function(n){var i={};i.buildingID=n.buildingController.getBuildingID(),i.position=n.buildingController.node.position,e.push(i),t.userController.setTowerBuildingRecord(e)})},clearBuilding:function(){Object.values(this.gridMap).forEach(function(t){t.buildingController.node.destroy()}),this.gridMap={}},clearRoad:function(){for(var t=this.roadLayer.children;0<t.length;)h.putObject(t[0])},clearBattle:function(){this._timeCounter=0,this._lastGenMonsterTime=0,Object.values(this.bulletMap).forEach(function(t){h.putObject(t.node)}),this.enemyOnRoad.forEach(function(t){h.putObject(t.node)}),this.enemyReach.forEach(function(t){h.putObject(t.node)}),this.enemyOnRoad=[],this.enemyReach=[],this.bulletMap={}},nextStage:function(){this.saveBuildingRecord(),this.clearBattle(),this.clearRoad(),this.clearBuilding();var t=o.getSetting("science"),e=this.stageSettingInfo,n=this.userController.getTechInfo(6),i=1+t.getScienceLevelInfo(n.id,n.level).value;this.userController.addCoin(Math.floor(e.gold*i)),this.userController.addDiamond(Math.floor(e.diamond*i)),this.stopDefend(),this.uiController.showStartButton(!0),this.uiController.hideResultWindow();var r=this.stage+1;this.userController.setStage(r),this.init(r,this.userController.getTowerBuildingRecord())},retry:function(){this.clearBattle(),this.stopDefend(),this.uiController.showStartButton(!0),this.uiController.hideResultWindow()},onTouchStart:function(t){this.isDefending()&&(this.speedDetect.active=!0,this.speedDetect.position=this.buildingLayer.convertToNodeSpaceAR(t))},onTouchMove:function(t){this.isDefending()&&(this.speedDetect.position=this.buildingLayer.convertToNodeSpaceAR(t))},onTouchEnd:function(){this.isDefending()&&(this.speedDetect.active=!1)},onTouchCancel:function(){this.isDefending()&&(this.speedDetect.active=!1)}}),cc._RF.pop()},{Astar:"Astar",combineController:"combineController",constant:"constant",helper:"helper",objectFactory:"objectFactory",settingMgr:"settingMgr",uiController:"uiController",userController:"userController"}],uiController:[function(t,e,n){"use strict";cc._RF.push(e,"3bb22JEOIlG54aiYSMau1hB","uiController");var i=t("settingMgr"),o=t("objectFactory");cc.Class({extends:cc.Component,properties:{coinNumLabel:cc.Label,diamondNumLabel:cc.Label,stageLabel:cc.Label,startButton:cc.Node,towerBuildingNum:cc.Label,winPanel:cc.Node,losePanel:cc.Node,tipPrefab:cc.Prefab,autoMoneyPrefab:cc.Prefab,offlinePanel:cc.Node,candyBagPanel:cc.Node,tipLayer:cc.Node},onLoad:function(){o.buildObjectPool(this.tipPrefab,5),o.buildObjectPool(this.autoMoneyPrefab,20)},showCandyBagPanel:function(){this.candyBagPanel.active=!0},showOfflinePanel:function(t,e){this.offlinePanel.active=!0,this.offlinePanel.getComponent("offlinePanelController").init(t,e)},destroyOfflinePanel:function(){this.offlinePanel.destroy()},hideResultWindow:function(){this.winPanel.active=!1,this.losePanel.active=!1},win:function(t){this.winPanel.active=!0,this.winPanel.getComponent("winPanelController").updateInfo(t)},lose:function(t){this.losePanel.active=!0,this.losePanel.getComponent("losePanelController").updateInfo(t)},updateCoin:function(t){this.coinNumLabel.string=t},updateDiamond:function(t){this.diamondNumLabel.string=t},updateStage:function(t){this.stageLabel.string=t},showStartButton:function(t){if(!t){var e=cc.sequence(cc.spawn(cc.scaleBy(.3,2),cc.fadeOut(1)),cc.callFunc(function(){this.startButton.scale=1,this.startButton.opacity=255,this.startButton.active=!1},this));return e.easing(cc.easeCubicActionOut()),void this.startButton.runAction(e)}this.startButton.active=t},updateTowerBuildingNum:function(t,e){var n=t+"/"+e;this.towerBuildingNum.string=n},generateTip:function(t,e){e=e||[];var n=i.getSetting("text").getText(t),r=o.getObject(this.tipPrefab);r.parent=this.node,r.position=cc.v2(0,0);for(var a=0;a<e.length;a++)n=n.replace("$[arg"+(a+1)+"]",e[a]);r.getComponent("tipController").setText(n)},generateAutoMoneyTip:function(t,e){var n=o.getObject(this.autoMoneyPrefab);n.parent=this.tipLayer,n.position=this.tipLayer.convertToNodeSpaceAR(t),n.getComponent("tipController").setText("+"+e)}}),cc._RF.pop()},{objectFactory:"objectFactory",settingMgr:"settingMgr"}],userController:[function(t,e,n){"use strict";cc._RF.push(e,"a993byD/oRBG5EuKbo+Cxn2","userController");var i=t("uiController"),o=t("settingMgr"),r=t("constant"),a=t("helper"),s=r.Event;cc.Class({extends:cc.Component,properties:{uiController:i,towerNode:cc.Node,combineNode:cc.Node,custom:cc.Boolean=!1,reset:cc.Boolean=!1,coin:cc.Integer,diamond:cc.Integer,stage:cc.Integer},onLoad:function(){this.schedule(this.saveUserInfo,5)},adjustUserInfo:function(t){var e=JSON.parse(t);return e&&e.version&&.2===e.version?t:(cc.log("adjustUserInfo"),this.saveUserInfo(),cc.sys.localStorage.getItem(r.UserInfoStorgeKey))},restore:function(){var t=cc.sys.localStorage.getItem(r.UserInfoStorgeKey);t=this.adjustUserInfo(t);var e=JSON.parse(t);if(cc.log("record: "+JSON.stringify(e)),0!==e.data.lastOnlineTime){var n=o.getSetting("constant").getValue("OFFLINE_REWARD_TIME_MAX"),i=a.nowUnixSec(),s=Math.floor(i-e.data.lastOnlineTime);s<0&&(s=0),s>=n&&(s=n);var c=this.getBuildingProfitPerSec();this.offlineProfit=Math.floor(s*c),this.offlineProfit}this.userInfo=e.data.userInfo,this.uiController.updateStage(this.userInfo.stage),this.uiController.updateCoin(this.userInfo.coin),this.uiController.updateDiamond(this.userInfo.diamond)},getBuildingProfitPerSec:function(){return 1},getOfflineProfitDouble:function(){this.addCoin(this.offlineProfit),this.uiController.destroyOfflinePanel()},getOfflineProfit:function(){this.addCoin(this.offlineProfit),this.uiController.destroyOfflinePanel()},saveUserInfo:function(t){t=t||!1;var e=a.nowUnixSec();t&&(e=0);var n={openid:"user-open-id",version:.2,data:{lastOnlineTime:e,userInfo:this.userInfo}},i=JSON.stringify(n);cc.sys.localStorage.setItem(r.UserInfoStorgeKey,i)},initTechInfo:function(){var t=this,e=o.getSetting("science").getInfoMap();Object.values(e).forEach(function(e){var n={};n.id=e.id,n.level=e.sciLvlArray[0].level,t.userInfo.techInfo.push(n)})},initBuyRecord:function(){var t=this,e=o.getSetting("buildingLevel").getInfoMap();Object.values(e).forEach(function(e){var n={};n.id=e.id,n.num=0,t.userInfo.buyRecord.push(n)})},initCandyBagRecord:function(){this.userInfo.candyBagRecord={},this.userInfo.candyBagRecord.timeStamp=0,this.userInfo.candyBagRecord.takeTimes=0},initDefault:function(){var t=o.getSetting("constant"),e=t.getValue("INIT_COIN_NUM"),n=t.getValue("INIT_DIAMOND_NUM");this.userInfo={},this.userInfo.stage=1,this.userInfo.coin=parseInt(e),this.userInfo.diamond=parseInt(n),this.userInfo.techInfo=[],this.userInfo.buyRecord=[],this.userInfo.packageRecord=[],this.userInfo.towerBuildingRecord=[],this.userInfo.candyBagRecord={},this.initCandyBagRecord(),this.initTechInfo(),this.initBuyRecord()},getCandyBagRecord:function(){return this.userInfo.candyBagRecord},setCandyBagRecord:function(t){this.userInfo.candyBagRecord=t},init:function(){this.initDefault(),this.restore(),this.custom&&(this.userInfo.stage=parseInt(this.stage),this.userInfo.coin=parseInt(this.coin),this.userInfo.diamond=parseInt(this.diamond),this.saveUserInfo()),this.reset&&(this.initDefault(),this.saveUserInfo(!0))},setTowerBuildingRecord:function(t){this.userInfo.towerBuildingRecord=t,this.saveUserInfo()},setPackageRecord:function(t){this.userInfo.packageRecord=t,this.saveUserInfo()},getTowerBuildingRecord:function(){return this.userInfo.towerBuildingRecord},setUserInfo:function(t){this.userInfo.stage=t.stage,this.userInof.coin=t.coin,this.userInfo.diamond=t.diamond,this.userInfo.techInfo=t.techInfo,this.userInfo.buyRecord=t.buyRecord,this.userInfo.towerBuildingRecord=t.towerBuildingRecord,this.saveUserInfo()},getUserInfo:function(){return this.userInfo},setStage:function(t){t=t||1,this.userInfo.stage=t,this.combineNode.emit(s.StageChange,this.userInfo),this.saveUserInfo()},getTechInfo:function(t){for(var e=0;e<this.userInfo.techInfo.length;e++){var n=this.userInfo.techInfo[e];if(n.id===t)return n}return null},getBuyRecord:function(t){for(var e=0;e<this.userInfo.buyRecord.length;e++){var n=this.userInfo.buyRecord[e];if(n.id===t)return n}return null},changeTechInfo:function(t,e){for(var n=0;n<this.userInfo.techInfo.length;n++){var i=this.userInfo.techInfo[n];if(i.id===t){i.level=e,this.towerNode.emit(s.TechInfoChange,t,e),this.combineNode.emit(s.TechInfoChange,t,e);break}}},addBuyRecord:function(t,e){for(var n=0;n<this.userInfo.buyRecord.length;n++){var i=this.userInfo.buyRecord[n];if(i.id===t){i.num+=e;break}}},getCoin:function(){return this.userInfo.coin},getStage:function(){return this.userInfo.stage},getAllTechInfo:function(){return this.userInfo.techInfo},isCoinEnough:function(t){return this.userInfo.coin>=t},setCoin:function(t){var e=o.getSetting("constant").getValue("COIN_MAX");this.userInfo.coin=t>e?e:t,this.uiController.updateCoin(this.userInfo.coin),this.saveUserInfo()},addCoin:function(t,e){var n=!0;null!==e&&(n=e);var i=o.getSetting("constant").getValue("COIN_MAX");if(this.userInfo.coin+t>i?this.userInfo.coin=i:this.userInfo.coin+=parseInt(t),this.uiController.updateCoin(this.userInfo.coin),this.saveUserInfo(),n){var r=[];r.push(t),this.uiController.generateTip("10002",r)}},reduceCoin:function(t){return!!this.isCoinEnough(t)&&(this.userInfo.coin-=t,this.uiController.updateCoin(this.userInfo.coin),this.saveUserInfo(),!0)},reduceDiamond:function(t){return!!this.isDiamondEnough(t)&&(this.userInfo.diamond-=t,this.uiController.updateDiamond(this.userInfo.diamond),this.saveUserInfo(),!0)},isDiamondEnough:function(t){return this.userInfo.diamond>=t},addDiamond:function(t,e){var n=!0;null!==e&&(n=e);var i=o.getSetting("constant").getValue("DIAMOND_MAX");if(this.userInfo.diamond+t>i?this.userInfo.diamond=i:this.userInfo.diamond+=parseInt(t),this.uiController.updateDiamond(this.userInfo.diamond),this.saveUserInfo(),n){var r=[];r.push(t),this.uiController.generateTip("10001",r)}},setDiamond:function(t){var e=o.getSetting("constant").getValue("DIAMOND_MAX");this.userInfo.diamond=t>e?e:t,this.userInfo.diamond=t,this.saveUserInfo(),this.uiController.updateDiamond(this.userInfo.diamond)}}),cc._RF.pop()},{constant:"constant",helper:"helper",settingMgr:"settingMgr",uiController:"uiController"}],winPanelController:[function(t,e,n){"use strict";cc._RF.push(e,"005edWkkP1O/LYfUF9rcLvo","winPanelController");var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),o=this&&this.__decorate||function(t,e,n,i){var o,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(r<3?o(a):r>3?o(e,n,a):o(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var r=cc._decorator,a=r.ccclass,s=r.property,c=t("../setting/settingMgr"),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.stageLabel=null,e.rewardCoinLabel=null,e.rewardCandyLabel=null,e}return i(e,t),e.prototype.updateInfo=function(t){this.stageLabel.string=t.toString();var e=c.getSetting("stages").getStageInfo(t);this.rewardCandyLabel.string=e.diamond,this.rewardCoinLabel.string=e.gold},e.prototype.share=function(){cc.log("WinPanelController Share")},o([s(cc.Label)],e.prototype,"stageLabel",void 0),o([s(cc.Label)],e.prototype,"rewardCoinLabel",void 0),o([s(cc.Label)],e.prototype,"rewardCandyLabel",void 0),e=o([a],e)}(cc.Component);n.default=l,cc._RF.pop()},{"../setting/settingMgr":"settingMgr"}]},{},["GodGuide","GodText","gameGuide","guideCommand","guideTask","async","loadGuide","locator","techGuideTask","buildingController","buildingPanelController","bulletController","candyBagController","combineController","combineEffectController","enemyController","enemyStateBarController","explodeController","losePanelController","offlinePanelController","operationController","slotController","techItemController","tipController","towerController","uiController","userController","winPanelController","gameManager","gameScene","buffSetting","buildingLevelSetting","buildingSetting","bulletSetting","constantSetting","enemyGroupSetting","enemySetting","mapSetting","scienceSetting","settingMgr","stagesSetting","textSetting","Astar","constant","helper","modalUI","objectFactory","onAnimationFinish","spriteSet","state-machine"]);